I"¶î<h4 id="ml-with-python-4-ë²”ì£¼í˜•-ë³€ìˆ˜--ì›-í•«-ì¸ì½”ë”©">[ML with Python] 4. ë²”ì£¼í˜• ë³€ìˆ˜ &amp; ì›-í•«-ì¸ì½”ë”©</h4>
<ul>
  <li>ë³¸ í¬ìŠ¤íŒ…ì€ ë²”ì£¼í˜• ë³€ìˆ˜ì™€ ì›-í•«-ì¸ì½”ë”©ì— ê´€í•œ ê¸°ë³¸ì ì¸ ë‚´ìš©ì— ê´€í•˜ì—¬ ë‹¤ë£¹ë‹ˆë‹¤.</li>
</ul>

<h1>Table of Contents<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#1)--ë²”ì£¼í˜•-ë³€ìˆ˜" data-toc-modified-id="1)--ë²”ì£¼í˜•-ë³€ìˆ˜-0">1)  <u>ë²”ì£¼í˜• ë³€ìˆ˜</u></a></span><ul class="toc-item"><li><span><a href="#1-1)-ì›---í•«---ì¸ì½”ë”©(ê°€ë³€ìˆ˜)" data-toc-modified-id="1-1)-ì›---í•«---ì¸ì½”ë”©(ê°€ë³€ìˆ˜)-0.1">1-1) <u>ì› - í•« - ì¸ì½”ë”©(ê°€ë³€ìˆ˜)</u></a></span></li><li><span><a href="#1-2)-ìˆ«ìë¡œ-í‘œí˜„ëœ-ë²”ì£¼í˜•-íŠ¹ì„±-" data-toc-modified-id="1-2)-ìˆ«ìë¡œ-í‘œí˜„ëœ-ë²”ì£¼í˜•-íŠ¹ì„±--0.2">1-2) <u>ìˆ«ìë¡œ í‘œí˜„ëœ ë²”ì£¼í˜• íŠ¹ì„± </u></a></span></li></ul></li><li><span><a href="#2)-OneHotEncoder-ì™€-ColumnTransformer" data-toc-modified-id="2)-OneHotEncoder-ì™€-ColumnTransformer-1">2) <u>OneHotEncoder ì™€ ColumnTransformer</u></a></span><ul class="toc-item"><li><span><a href="#2-1)-make_column_transformerë¡œ-ê°„í¸í•˜ê²Œ-ColumnTransformer-ë§Œë“¤ê¸°" data-toc-modified-id="2-1)-make_column_transformerë¡œ-ê°„í¸í•˜ê²Œ-ColumnTransformer-ë§Œë“¤ê¸°-1.1">2-1) <u>make_column_transformerë¡œ ê°„í¸í•˜ê²Œ ColumnTransformer ë§Œë“¤ê¸°</u></a></span></li></ul></li><li><span><a href="#References" data-toc-modified-id="References-2">References</a></span></li></ul></div>

<hr />

<p>í•„ìš”ë¼ì´ë¸ŒëŸ¬ë¦¬ import</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">mglearn</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">warnings</span><span class="p">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s">'ignore'</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<hr />

<h3 id="1--ë²”ì£¼í˜•-ë³€ìˆ˜">1)  <u>ë²”ì£¼í˜• ë³€ìˆ˜</u></h3>

<p>ì•ì—ì„œëŠ” ê³„ì† <code class="language-plaintext highlighter-rouge">ì—°ì†í˜• íŠ¹ì„±(continuous feature)</code>ì´ë¼ ê°€ì •í•˜ë©° ê³µë¶€ë¥¼ í•´ì™”ë‹¤. í•˜ì§€ë§Œ ëŒ€ë¶€ë¶„ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ì´ë ‡ê²Œ ì¹œì ˆí•˜ê²Œ ë°ì´í„°ê°€ ìˆ˜ì§‘ë˜ì§€ ì•ŠëŠ”ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë³´í†µì€ <code class="language-plaintext highlighter-rouge">ë²”ì£¼í˜•/ì´ì‚°í˜• íŠ¹ì„±(categorical/discrete feature)</code>ì´ë‹¤. ì—°ì†í˜•ê³¼ ë²”ì£¼í˜•ì€ ë§¤ìš° í° ì°¨ì´ê°€ ìˆë‹¤ê³ ëŠ” ë§í•  ìˆ˜ ì—†ì§€ë§Œ <u>(1)ì¶œë ¥ì´ ì•„ë‹Œ ì…ë ¥ì— ëŒ€í•œ ê²ƒ</u>ì´ë€ ì ì´ ë‹¤ë¥´ë‹¤. ì˜ˆë¥¼ ë“¤ìë©´, ì œí’ˆì˜ ë¸Œëœë“œ, ìƒ‰ìƒ, íŒë§¤ ë¶„ë¥˜ ë“±ì´ ë²”ì£¼í˜• íŠ¹ì„±ì— ì†í•œë‹¤. ì˜ˆì‹œì—ì„œë„ í™•ì¸í•  ìˆ˜ë„ ìˆë“¯ì´ ë²”ì£¼í˜• íŠ¹ì„±ì€ <u>(2)ì—°ì†ëœ ê°’ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ì§€ ì•ŠëŠ”ë‹¤</u>. ë˜í•œ <u>(3)ìˆœì„œê°€ ì—†ë‹¤</u>.</p>

<p><br /></p>

<p>í•˜ì§€ë§Œ, ë°ì´í„°ê°€ ì–´ë–¤ í˜•íƒœì˜ íŠ¹ì„±ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆëŠ”ê°€ë³´ë‹¤ ë¨¸ì‹ ëŸ¬ë‹ì—ì„œ ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ í‘œí˜„í•˜ëŠ”ê°€ì— ë”°ë¼ì„œ ì‚¬ìš©í•˜ëŠ” ëª¨ë¸ì˜ ì„±ëŠ¥ì´ ë§¤ìš° ë‹¬ë¼ì§„ë‹¤. ì´ì²˜ëŸ¼ íŠ¹ì • ì–´í”Œë¦¬ì¼€ì´ì…˜ì— ê°€ì¥ ì í•©í•œ ë°ì´í„° í‘œí˜„ì„ ì°¾ëŠ” ê²ƒì„ <code class="language-plaintext highlighter-rouge">íŠ¹ì„± ê³µí•™(feature engineering)</code>ì´ë¼ê³  í•œë‹¤. ì˜¬ë°”ë¥¸ ë°ì´í„° í‘œí˜„ì€ ì§€ë„ í•™ìŠµ ëª¨ë¸ì—ì„œ ì ì ˆí•œ ë§¤ê°œë³€ìˆ˜ë¥¼ ì„ íƒí•˜ëŠ” ê²ƒë³´ë‹¤ ì„±ëŠ¥ì— ë” í° ì˜í–¥ì„ ë¼ì¹œë‹¤.</p>

<p><br /></p>

<p>ê·¸ë ‡ë‹¤ë©´ ë§Œì•½ â€œí•™ì‚¬â€, â€œì„ì‚¬â€, â€œë°•ì‚¬â€ì™€ ê°™ì€ ë²”ì£¼í˜• ë³€ìˆ˜ë“¤ì„ ë¡œì§€ìŠ¤í‹± íšŒê·€ì™€ ê°™ì€ ì•Œê³ ë¦¬ì¦˜ì— í•™ìŠµì‹œí‚¬ë ¤ë©´ ì–´ë–»ê²Œí•´ì•¼ í• ê¹Œ? ë¡œì§€ìŠ¤í‹± íšŒê·€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë³€ìˆ˜ë“¤ì€ ìˆ«ìì—¬ì•¼ í•˜ë¯€ë¡œ  â€œí•™ì‚¬â€, â€œì„ì‚¬â€, â€œë°•ì‚¬â€ëŠ” ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ìœ„í•œ ë³€ìˆ˜ê°€ ë  ìˆ˜ ì—†ë‹¤. ë”°ë¼ì„œ, <u>ì´ë¥¼ íšŒê·€ì— ì‚¬ìš©í•˜ë ¤ë©´ ë°ì´í„°ë¥¼ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ í‘œí˜„í•´ì•¼ í•œë‹¤</u>.</p>

<p><br /></p>

<hr />

<h4 id="1-1-ì›---í•«---ì¸ì½”ë”©ê°€ë³€ìˆ˜">1-1) <u>ì› - í•« - ì¸ì½”ë”©(ê°€ë³€ìˆ˜)</u></h4>

<ul>
  <li>ë²”ì£¼í˜• ë³€ìˆ˜ë¥¼ í‘œí˜„í•˜ëŠ” ë° ê°€ì¥ ë„ë¦¬ ì“°ì´ëŠ” ë°©ë²•</li>
  <li>ë²”ì£¼í˜• ë³€ìˆ˜ë¥¼ 0 ë˜ëŠ” 1 ê°’ì„ ê°€ì§„ í•˜ë‚˜ ì´ìƒì˜ ìƒˆë¡œìš´ íŠ¹ì„±ìœ¼ë¡œ ë°”ê¾¼ë‹¤.</li>
</ul>

<p><br /></p>

<p><code class="language-plaintext highlighter-rouge">pandas</code>ë‚˜ <code class="language-plaintext highlighter-rouge">scikit-learn</code>ì„ ì´ìš©í•´ ë²”ì£¼í˜• ë³€ìˆ˜ë¥¼ <code class="language-plaintext highlighter-rouge">ì›-í•« ì¸ì½”ë”©</code>ìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œëŠ” <code class="language-plaintext highlighter-rouge">pandas</code>ë¡œ ì‹¤ì „ì²˜ëŸ¼ ì§„í–‰í•´ë³´ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># ì´ íŒŒì¼ì€ ì—´ ì´ë¦„ì„ ë‚˜íƒ€ë‚´ëŠ” í—¤ë”ê°€ ì—†ìœ¼ë¯€ë¡œ header=Noneìœ¼ë¡œ ì§€ì •í•˜ê³ 
# "names" ë§¤ê°œë³€ìˆ˜ë¡œ ì—´ ì´ë¦„ì„ ì œê³µí•©ë‹ˆë‹¤
</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">mglearn</span><span class="p">.</span><span class="n">datasets</span><span class="p">.</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="s">"adult.data"</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">'age'</span><span class="p">,</span> <span class="s">'workclass'</span><span class="p">,</span> <span class="s">'fnlwgt'</span><span class="p">,</span> <span class="s">'education'</span><span class="p">,</span>  <span class="s">'education-num'</span><span class="p">,</span>
           <span class="s">'marital-status'</span><span class="p">,</span> <span class="s">'occupation'</span><span class="p">,</span> <span class="s">'relationship'</span><span class="p">,</span> <span class="s">'race'</span><span class="p">,</span> <span class="s">'gender'</span><span class="p">,</span>
           <span class="s">'capital-gain'</span><span class="p">,</span> <span class="s">'capital-loss'</span><span class="p">,</span> <span class="s">'hours-per-week'</span><span class="p">,</span> <span class="s">'native-country'</span><span class="p">,</span>
           <span class="s">'income'</span><span class="p">])</span>
<span class="c1"># ì˜ˆì œë¥¼ ìœ„í•´ ëª‡ê°œì˜ ì—´ë§Œ ì„ íƒí•©ë‹ˆë‹¤
</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s">'age'</span><span class="p">,</span> <span class="s">'workclass'</span><span class="p">,</span> <span class="s">'education'</span><span class="p">,</span> <span class="s">'gender'</span><span class="p">,</span> <span class="s">'hours-per-week'</span><span class="p">,</span>
             <span class="s">'occupation'</span><span class="p">,</span> <span class="s">'income'</span><span class="p">]]</span>
<span class="c1"># IPython.display í•¨ìˆ˜ëŠ” ì£¼í”¼í„° ë…¸íŠ¸ë¶ì„ ìœ„í•´ í¬ë§·íŒ…ëœ ì¶œë ¥ì„ ë§Œë“­ë‹ˆë‹¤
</span><span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">head</span><span class="p">())</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>education</th>
      <th>gender</th>
      <th>hours-per-week</th>
      <th>occupation</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39</td>
      <td>State-gov</td>
      <td>Bachelors</td>
      <td>Male</td>
      <td>40</td>
      <td>Adm-clerical</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>Self-emp-not-inc</td>
      <td>Bachelors</td>
      <td>Male</td>
      <td>13</td>
      <td>Exec-managerial</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Male</td>
      <td>40</td>
      <td>Handlers-cleaners</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>3</th>
      <td>53</td>
      <td>Private</td>
      <td>11th</td>
      <td>Male</td>
      <td>40</td>
      <td>Handlers-cleaners</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>4</th>
      <td>28</td>
      <td>Private</td>
      <td>Bachelors</td>
      <td>Female</td>
      <td>40</td>
      <td>Prof-specialty</td>
      <td>&lt;=50K</td>
    </tr>
  </tbody>
</table>
</div>

<p>ìœ„ì™€ ê°™ì´ ë°ì´í„°ì…‹ì„ í™•ì¸í–ˆì„ ë•Œ, <u>ë¨¼ì € ì—´ì— ì–´ë–¤ ì˜ë¯¸ìˆëŠ” ë²”ì£¼í˜• ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸í•´ì•¼í•œë‹¤</u>. ì–´í”Œë¦¬ì¼€ì´ì…˜ ì‚¬ìš©ìë¡œë¶€í„° ì…ë ¥ë°›ì€ ë°ì´í„°ë¥¼ ë‹¤ë£° ë•ŒëŠ” ì—¬ëŸ¬ê°€ì§€ ì˜ˆìƒ ë°–ì˜ ìƒí™©ì´ ìˆì„ ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ë“¤ì–´, ì² ì í˜¹ì€ ëŒ€ì†Œë¬¸ìê°€ í‹€ë¦¬ê±°ë‚˜, ë‚¨ì„±ì„ â€œmaleâ€ ë˜ëŠ” â€œmanâ€ì´ë¼ê³ ë„ í‘œí˜„í•  ìˆ˜ ìˆë‹¤. â€œmaleâ€ê³¼ â€œmanâ€ì˜ ê²½ìš°ëŠ” ë˜ ë‘˜ì´ ê°™ì€ ì…ë ¥ê°’ìœ¼ë¡œ ì·¨ê¸‰í•´ì¤˜ì•¼í•œë‹¤. ë”°ë¼ì„œ, ë°ì´í„°ì…‹ì„ ë°›ê³  ê°€ì¥ ë¨¼ì € í•  ì¼ì€ ë²”ì£¼í˜• ë°ì´í„°ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì´ë‹¤.</p>

<p><br /></p>

<p>ì—´ì˜ ë‚´ìš©ì„ í™•ì¸í•˜ëŠ” ê°€ì¥ ì¢‹ì€ ë°©ë²•ì€ <code class="language-plaintext highlighter-rouge">Series</code>ì˜ <code class="language-plaintext highlighter-rouge">value_counts</code>ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ <u>ë²”ì£¼í˜• ë°ì´í„°ì˜ ìœ ì¼ê°’ì´ ê°ê° ëª‡ ë²ˆ ë‚˜íƒ€ë‚˜ëŠ”ì§€ ì¶œë ¥í•˜ëŠ” ê²ƒ</u>ì´ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"gender :</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s">'gender'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">())</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"workclass :</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s">'workclass'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">())</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"occupation :</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s">'occupation'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gender :
  Male      21790
 Female    10771
Name: gender, dtype: int64

workclass :
  Private             22696
 Self-emp-not-inc     2541
 Local-gov            2093
 ?                    1836
 State-gov            1298
 Self-emp-inc         1116
 Federal-gov           960
 Without-pay            14
 Never-worked            7
Name: workclass, dtype: int64

occupation :
  Prof-specialty       4140
 Craft-repair         4099
 Exec-managerial      4066
 Adm-clerical         3770
 Sales                3650
 Other-service        3295
 Machine-op-inspct    2002
 ?                    1843
 Transport-moving     1597
 Handlers-cleaners    1370
 Farming-fishing       994
 Tech-support          928
 Protective-serv       649
 Priv-house-serv       149
 Armed-Forces            9
Name: occupation, dtype: int64
</code></pre></div></div>

<p><br /></p>

<p><code class="language-plaintext highlighter-rouge">pandas</code>ì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">get_dummies</code>í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì‰½ê²Œ ë²”ì£¼í˜• ë°ì´í„°ë¥¼ ì¸ì½”ë”©í•  ìˆ˜ ìˆë‹¤.</p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">get_dummies</code> :
ê°ì²´(object) íƒ€ì… í˜¹ì€ ë²”ì£¼í˜•(categorical)ê°€ì§„ ì—´ì„ ìë™ìœ¼ë¡œ ë³€í™˜í•´ì¤€ë‹¤.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"ì›ë³¸ íŠ¹ì„± :</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">columns</span><span class="p">),</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="n">data_dummies</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"ì›ë³¸ íŠ¹ì„± :</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dummies</span><span class="p">.</span><span class="n">columns</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ì›ë³¸ íŠ¹ì„± :
 ['age', 'workclass', 'education', 'gender', 'hours-per-week', 'occupation', 'income'] 

ì›ë³¸ íŠ¹ì„± :
 ['age', 'hours-per-week', 'workclass_ ?', 'workclass_ Federal-gov', 'workclass_ Local-gov', 'workclass_ Never-worked', 'workclass_ Private', 'workclass_ Self-emp-inc', 'workclass_ Self-emp-not-inc', 'workclass_ State-gov', 'workclass_ Without-pay', 'education_ 10th', 'education_ 11th', 'education_ 12th', 'education_ 1st-4th', 'education_ 5th-6th', 'education_ 7th-8th', 'education_ 9th', 'education_ Assoc-acdm', 'education_ Assoc-voc', 'education_ Bachelors', 'education_ Doctorate', 'education_ HS-grad', 'education_ Masters', 'education_ Preschool', 'education_ Prof-school', 'education_ Some-college', 'gender_ Female', 'gender_ Male', 'occupation_ ?', 'occupation_ Adm-clerical', 'occupation_ Armed-Forces', 'occupation_ Craft-repair', 'occupation_ Exec-managerial', 'occupation_ Farming-fishing', 'occupation_ Handlers-cleaners', 'occupation_ Machine-op-inspct', 'occupation_ Other-service', 'occupation_ Priv-house-serv', 'occupation_ Prof-specialty', 'occupation_ Protective-serv', 'occupation_ Sales', 'occupation_ Tech-support', 'occupation_ Transport-moving', 'income_ &lt;=50K', 'income_ &gt;50K']
</code></pre></div></div>

<p>ìœ„ì—ì„œ ì—°ì†í˜• ë³€ìˆ˜ëŠ” ê·¸ëŒ€ë¡œì§€ë§Œ, ë²”ì£¼í˜• ë³€ìˆ˜ì¸ â€œworkclassâ€, â€œeducationâ€, â€œgenderâ€, â€œoccupationâ€ì€ ê°€ì§„ ë³€ìˆ˜ê°’ë³„ë¡œ ìƒˆë¡œìš´ íŠ¹ì„±ìœ¼ë¡œ í™•ì¥ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  ë³€í™˜ëœ ë°ì´í„° í”„ë ˆì„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_dummies</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>hours-per-week</th>
      <th>workclass_ ?</th>
      <th>workclass_ Federal-gov</th>
      <th>workclass_ Local-gov</th>
      <th>workclass_ Never-worked</th>
      <th>workclass_ Private</th>
      <th>workclass_ Self-emp-inc</th>
      <th>workclass_ Self-emp-not-inc</th>
      <th>workclass_ State-gov</th>
      <th>...</th>
      <th>occupation_ Machine-op-inspct</th>
      <th>occupation_ Other-service</th>
      <th>occupation_ Priv-house-serv</th>
      <th>occupation_ Prof-specialty</th>
      <th>occupation_ Protective-serv</th>
      <th>occupation_ Sales</th>
      <th>occupation_ Tech-support</th>
      <th>occupation_ Transport-moving</th>
      <th>income_ &lt;=50K</th>
      <th>income_ &gt;50K</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39</td>
      <td>40</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>13</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>40</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>53</td>
      <td>40</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>28</td>
      <td>40</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 46 columns</p>
</div>

<p><br /></p>

<p>ì´ì œ ì´ë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ì— í•™ìŠµì‹œì¼œë³´ì. í•™ìŠµì‹œí‚¬ ë•Œ íƒ€ê¹ƒê°’ì€ â€œincomeâ€ìœ¼ë¡œ ì§€ì •í•œë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">features</span> <span class="o">=</span> <span class="n">data_dummies</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s">'age'</span><span class="p">:</span><span class="s">'occupation_ Transport-moving'</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">features</span><span class="p">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data_dummies</span><span class="p">[</span><span class="s">'income_ &lt;=50K'</span><span class="p">].</span><span class="n">values</span>
<span class="k">print</span><span class="p">(</span><span class="s">"X.shape : {0}, y.shape : {1}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="p">.</span><span class="n">shape</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>X.shape : (32561, 44), y.shape : (32561,)
</code></pre></div></div>

<p><br /></p>

<p>ì´ì œ scikit_learnì˜ ë¡œì§€ìŠ¤í‹± íšŒê·€ì— ì‚¬ìš©ê°€ëŠ¥í•œ ëª¨ë¸ì´ ë˜ì—ˆìœ¼ë‹ˆ ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ëª¨ë¸ì— ì ìš©í•œë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">logreg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">logreg</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"í…ŒìŠ¤íŠ¸ ì ìˆ˜ : {:.2f}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">logreg</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>í…ŒìŠ¤íŠ¸ ì ìˆ˜ : 0.81
</code></pre></div></div>

<p><br /></p>

<hr />

<h4 id="1-2-ìˆ«ìë¡œ-í‘œí˜„ëœ-ë²”ì£¼í˜•-íŠ¹ì„±-">1-2) <u>ìˆ«ìë¡œ í‘œí˜„ëœ ë²”ì£¼í˜• íŠ¹ì„± </u></h4>

<p>ì—¬ê¸°ê¹Œì§€ ê³µë¶€í•˜ë©´ì„œ <del>â€œë²”ì£¼í˜• íŠ¹ì„± = ë¬¸ìì—´â€</del>ì´ë¼ê³  ìƒê°í•˜ëŠ” ê²ƒì€ ê¸ˆë¬¼ì´ë‹¤. í”íˆ ë§í•˜ëŠ” ê¸°ì¶œë³€í˜•ì˜ í˜•íƒœë¡œ <code class="language-plaintext highlighter-rouge">ë²”ì£¼í˜• ë³€ìˆ˜</code>ê°€ <code class="language-plaintext highlighter-rouge">ìˆ«ì</code>ë¡œ ì¸ì½”ë”©ëœ ê²½ìš°ë„ ë§ë‹¤. ì´ëŸ¬í•œ ë²”ì£¼í˜• ë³€ìˆ˜ë“¤ì€ ê²‰ìœ¼ë¡œ ë³´ê¸°ì—ëŠ” ì—°ì†í˜• ë³€ìˆ˜ë¡œ ì°©ê°í•˜ê¸° ì‰¬ì›Œì„œ ì£¼ì˜í•´ì•¼í•œë‹¤.</p>

<p><br /></p>

<p>ì•ì„œ ì‚¬ìš©í•œ pandasì˜ <code class="language-plaintext highlighter-rouge">get_dummies</code>í•¨ìˆ˜ì˜ ê²½ìš° <code class="language-plaintext highlighter-rouge">ìˆ«ìíŠ¹ì„±ì„ ëª¨ë‘ ì—°ì†í˜•ì´ë¼ê³  ìƒê°</code><u>í•´ì„œ ê°€ë³€ìˆ˜ë¥¼ ë§Œë“¤ì§€ ì•Šê¸° ë•Œë¬¸ì´ë‹¤</u>. ë‹¤ìŒì˜ ê°ê° ë¬¸ìì—´ê³¼ ìˆ«ìë¡œ í‘œí˜„ëœ ë‘ ê°œì˜ ë²”ì£¼í˜• íŠ¹ì„±ì„ ê°€ì§„ ë°ì´í„°í”„ë ˆì„ì„ ì˜ˆì œë¡œ ì‚´í´ë³´ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">demo_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'ìˆ«ì íŠ¹ì„±'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'ë²”ì£¼í˜• íŠ¹ì„±'</span> <span class="p">:</span> <span class="p">[</span><span class="s">'ì–‘ë§'</span><span class="p">,</span> <span class="s">'ì—¬ìš°'</span><span class="p">,</span> <span class="s">'ì–‘ë§'</span><span class="p">,</span> <span class="s">'ìƒì'</span><span class="p">]})</span>
<span class="n">demo_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ìˆ«ì íŠ¹ì„±</th>
      <th>ë²”ì£¼í˜• íŠ¹ì„±</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>ì–‘ë§</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>ì—¬ìš°</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>ì–‘ë§</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>ìƒì</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">demo_df</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ìˆ«ì íŠ¹ì„±</th>
      <th>ë²”ì£¼í˜• íŠ¹ì„±_ìƒì</th>
      <th>ë²”ì£¼í˜• íŠ¹ì„±_ì–‘ë§</th>
      <th>ë²”ì£¼í˜• íŠ¹ì„±_ì—¬ìš°</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<p><br /></p>

<p>í•˜ì§€ë§Œ, <code class="language-plaintext highlighter-rouge">ìˆ«ì íŠ¹ì„±</code>ë„ ê°€ë³€ìˆ˜ë¡œ ë§Œë“¤ê³  ì‹¶ì„ ê²½ìš° <code class="language-plaintext highlighter-rouge">colums</code>ë§¤ê°œë³€ìˆ˜ì— ì¸ì½”ë”©í•˜ê³  ì‹¶ì€ ì—´ì„ ë‹¤ìŒê³¼ ê°™ì´ ëª…ì‹œí•˜ë©´ëœë‹¤. í˜¹ì€ <code class="language-plaintext highlighter-rouge">ìˆ«ì íŠ¹ì„±</code>ì˜ ìˆ«ìë“¤ì„ <code class="language-plaintext highlighter-rouge">astype</code>ê³¼ ê°™ì€ í•¨ìˆ˜ë¥¼ í†µí•´ ë¬¸ìí˜•ìœ¼ë¡œ ë°”ê¾¸ì–´ì£¼ë©´ <code class="language-plaintext highlighter-rouge">columns</code>ë¡œ ì§€ì •í•˜ì§€ ì•Šì•„ë„ ê°€ë³€ìˆ˜ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤.</p>

<ul>
  <li><b>ì •ë¦¬ : ìˆ«ì íŠ¹ì„±ì„ ê°€ë³€ìˆ˜ë¡œ ë§Œë“œëŠ” ë°©ë²•</b>
    <ul>
      <li>
        <ol>
          <li>get_dummiesì˜ ë§¤ê°œë³€ìˆ˜  columnsì— ìˆ«ì íŠ¹ì„±ì„ ê°€ì§„ ì—´ì„ ëª…ì‹œí•´ì¤€ë‹¤.</li>
        </ol>
      </li>
      <li>
        <ol>
          <li>ìˆ«ì íŠ¹ì„±ì„ ê°€ì§„ ì—´ì„ ë¬¸ìì—´ë¡œ ë³€í™˜ì‹œì¼œì¤€ë‹¤.</li>
        </ol>
      </li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># columnsë¡œ ì œì‹œí•  ê²½ìš°
</span><span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">demo_df</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'ìˆ«ì íŠ¹ì„±'</span><span class="p">,</span> <span class="s">'ë²”ì£¼í˜• íŠ¹ì„±'</span><span class="p">])</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ìˆ«ì íŠ¹ì„±_0</th>
      <th>ìˆ«ì íŠ¹ì„±_1</th>
      <th>ìˆ«ì íŠ¹ì„±_2</th>
      <th>ë²”ì£¼í˜• íŠ¹ì„±_ìƒì</th>
      <th>ë²”ì£¼í˜• íŠ¹ì„±_ì–‘ë§</th>
      <th>ë²”ì£¼í˜• íŠ¹ì„±_ì—¬ìš°</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># astypeì„ ì´ìš©í•´ ë¬¸ìí˜•ìœ¼ë¡œ ë³€ê²½í•  ê²½ìš°
</span><span class="n">demo_df</span><span class="p">[</span><span class="s">'ìˆ«ì íŠ¹ì„±'</span><span class="p">]</span> <span class="o">=</span> <span class="n">demo_df</span><span class="p">[</span><span class="s">'ìˆ«ì íŠ¹ì„±'</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">demo_df</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ìˆ«ì íŠ¹ì„±_0</th>
      <th>ìˆ«ì íŠ¹ì„±_1</th>
      <th>ìˆ«ì íŠ¹ì„±_2</th>
      <th>ë²”ì£¼í˜• íŠ¹ì„±_ìƒì</th>
      <th>ë²”ì£¼í˜• íŠ¹ì„±_ì–‘ë§</th>
      <th>ë²”ì£¼í˜• íŠ¹ì„±_ì—¬ìš°</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<p><br /></p>

<hr />

<h3 id="2-onehotencoder-ì™€-columntransformer">2) <u>OneHotEncoder ì™€ ColumnTransformer</u></h3>

<p>ì•ì—ì„œì™€ ê°™ì´ <code class="language-plaintext highlighter-rouge">pandas</code>ì˜ <code class="language-plaintext highlighter-rouge">get_dummies</code>í•¨ìˆ˜ë¡œ <code class="language-plaintext highlighter-rouge">ì›-í•«-ì¸ì½”ë”©</code>ì„ ìˆ˜í–‰í•œ ê²ƒ ì²˜ëŸ¼, <code class="language-plaintext highlighter-rouge">scikit-learn</code>ì˜ <code class="language-plaintext highlighter-rouge">OneHotEncoder</code>í´ë˜ìŠ¤ì—ì„œë„ <code class="language-plaintext highlighter-rouge">ì›-í•«-ì¸ì½”ë”©</code>ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ, ì•ì˜ <code class="language-plaintext highlighter-rouge">get_dummies</code><u>ì™€ ë‹¬ë¦¬ </u><code class="language-plaintext highlighter-rouge">OneHotEncoder</code><u>ëŠ” ëª¨ë“  ì—´ì— ì¸ì½”ë”©ì„ ìˆ˜í–‰í•œë‹¤</u>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>

<span class="c1"># sparseë¥¼ Trueë¡œ í•  ê²½ìš° "(í–‰, ì—´) 1"ì˜ ì¢Œí‘œë¦¬ìŠ¤íŠ¸ì˜ í˜•ì‹ìœ¼ë¡œ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤.
# í•˜ì§€ë§Œ, Falseë¡œ í•  ê²½ìš° ë„˜íŒŒì´ ë°°ì—´ë¡œ ë°˜í™˜ëœë‹¤.
</span><span class="n">ohe</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ohe</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">demo_df</span><span class="p">))</span>

<span class="c1"># ê²°ê³¼ê°€ pandasì˜ get_dummiesë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ì—´ì„ ê°€ë³€ìˆ˜í™” ì‹œì¼°ì„ ë•Œì™€ ê°™ìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
# scikit-learnì—ì„œì˜ ì¶œë ¥ì€ DataFrameì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ì¹œì ˆí•˜ê²Œ ì—´ ì´ë¦„ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤.
</span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ohe</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">demo_df</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[[1. 0. 0. 0. 1. 0.]
 [0. 1. 0. 0. 0. 1.]
 [0. 0. 1. 0. 1. 0.]
 [0. 1. 0. 1. 0. 0.]]
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>

<p><br /></p>

<p>ë³€í™˜ëœ íŠ¹ì„±ì— í•´ë‹¹í•˜ëŠ” ì›ë³¸ ë²”ì£¼í˜• ë³€ìˆ˜ ì´ë¦„ì„ ì–»ìœ¼ë ¤ë©´ <code class="language-plaintext highlighter-rouge">get_feature_names</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤. ì•„ë˜ì˜ ì˜ˆì œì—ì„œ ì²« ë²ˆì§¸ ì›ë³¸ íŠ¹ì„±(x0)ëŠ” â€œìˆ«ì íŠ¹ì„±â€, ë‘ ë²ˆì§¸ ì›ë³¸ íŠ¹ì„±(x1)ëŠ” â€œë²”ì£¼í˜• íŠ¹ì„±â€ì´ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">ohe</span><span class="p">.</span><span class="n">get_feature_names</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['x0_0' 'x0_1' 'x0_2' 'x1_ìƒì' 'x1_ì–‘ë§' 'x1_ì—¬ìš°']
</code></pre></div></div>

<p><br /></p>

<p>ì—¬ê¸°ê¹Œì§€ ê³µë¶€í•´ë´¤ì„ ë•Œ, ìƒê°í•˜ëŠ” ê²ƒì€ â€œêµ³ì´ <code class="language-plaintext highlighter-rouge">OneHotEncoder</code>ë¥¼ ì“¸ í•„ìš”ê°€ ìˆëŠ”ê±´ê°€?â€ ì˜€ë‹¤. ì™œëƒí•˜ë©´, <code class="language-plaintext highlighter-rouge">OneHotEncoder</code>ëŠ” ëª¨ë“  íŠ¹ì„±ì„ ë²”ì£¼í˜•ì´ë¼ê³  ê°€ì •í•  ë¿ë”ëŸ¬ <code class="language-plaintext highlighter-rouge">get_dummies</code>ëŠ” ë¬¸ìí˜• íŠ¹ì„±ë§Œì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ê°€ë³€ìˆ˜ë¡œ ë°”ê¿€ ìˆ˜ ìˆì—ˆìœ¼ë©°, í•„ìš”ì— ë”°ë¼ columsë§¤ê°œë³€ìˆ˜ì— ì—´ì„ ì¶”ê°€í•  ìˆ˜ ìˆì—ˆë‹¤. í•˜ì§€ë§Œ, <code class="language-plaintext highlighter-rouge">ColumnTransformer</code>ë•Œë¬¸ì— ì‚¬ìš©í•  ê°€ì¹˜ê°€ ì¶©ë¶„í•˜ë‹¤ê³  ìƒê°ì´ ë°”ë€Œì—ˆë‹¤.</p>

<p><br /></p>

<p><code class="language-plaintext highlighter-rouge">ColumnTransformer</code>í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê²Œë˜ë©´, <u>ì…ë ¥ ë°ì´í„°ì— ìˆëŠ” ì—´ë§ˆë‹¤ ë‹¤ë¥¸ ë³€í™˜ì„ ì ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤</u>(ã…ã„·ã„·â€¦). ì—°ì†í˜• íŠ¹ì„±ê³¼ ë²”ì£¼í˜• íŠ¹ì„±ì€ ë§¤ìš° ë‹¤ë¥¸ ì¢…ë¥˜ì˜ ì „ì²˜ë¦¬ ê³¼ì •ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ì´í´ë˜ìŠ¤ëŠ” ë§¤ìš° ìœ ìš©í•˜ë‹¤. ì´ë¥¼ í™•ì¸í•˜ê¸°ìœ„í•´ ë‹¤ìŒì˜ ë°ì´í„°í”„ë ˆì„ì„ ì‚´í´ë³´ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>education</th>
      <th>gender</th>
      <th>hours-per-week</th>
      <th>occupation</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39</td>
      <td>State-gov</td>
      <td>Bachelors</td>
      <td>Male</td>
      <td>40</td>
      <td>Adm-clerical</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>Self-emp-not-inc</td>
      <td>Bachelors</td>
      <td>Male</td>
      <td>13</td>
      <td>Exec-managerial</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Male</td>
      <td>40</td>
      <td>Handlers-cleaners</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>3</th>
      <td>53</td>
      <td>Private</td>
      <td>11th</td>
      <td>Male</td>
      <td>40</td>
      <td>Handlers-cleaners</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>4</th>
      <td>28</td>
      <td>Private</td>
      <td>Bachelors</td>
      <td>Female</td>
      <td>40</td>
      <td>Prof-specialty</td>
      <td>&lt;=50K</td>
    </tr>
  </tbody>
</table>
</div>

<p>ì´ ë°ì´í„°ì…‹ì— ì„ í˜• íšŒê·€ëª¨ë¸ì„ ì ìš©í•˜ì—¬ ì†Œë“ì„ ì˜ˆì¸¡í•˜ë ¤ë©´</p>
<ul>
  <li>ë²”ì£¼í˜• ë³€ìˆ˜ë¥¼ <code class="language-plaintext highlighter-rouge">ì›-í•«-ì¸ì½”ë”©</code>ë¡œ ë³€í™˜</li>
  <li>ì—°ì†í˜• ë³€ìˆ˜ age ì—´ê³¼ hours-per-week ì—´ì˜ <code class="language-plaintext highlighter-rouge">ìŠ¤ì¼€ì¼ ì¡°ì •</code>ì´ í•„ìš”</li>
</ul>

<p>ì´ë¼ëŠ” ë‘ ê°€ì§€ì˜ ë³€í™˜ì´ í•„ìš”í•˜ë‹¤. ì´ë•Œ ë¹›ë‚˜ëŠ” ê²ƒì´ <code class="language-plaintext highlighter-rouge">ColumnTransformer</code>ì´ë‹¤.<br />
<code class="language-plaintext highlighter-rouge">CounterTransformer</code>ëŠ” ë‹¤ìŒì˜ ê²ƒë“¤ì´ listë¡œ ì§€ì •í•´ì•¼ í•œë‹¤.</p>
<ul>
  <li>ì´ë¦„</li>
  <li>ë³€í™˜ê¸° ê°ì²´ (ex. StandardScaler)</li>
  <li>ë³€í™˜ëœ ì—´ì˜ ì´ë¦„ (ë§Œì•½, DataFrameì´ ì•„ë‹ˆë¼ ë°°ì—´ì—ì„œ ì‚¬ìš©í•  ê²½ìš° ì •ìˆ˜ ì¸ë±ìŠ¤ë‚˜ ë¶ˆë¦° ë§ˆìŠ¤í¬ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.)</li>
</ul>

<p>ë‹¤ìŒì˜ ì˜ˆë¥¼ ì‚´í´ë³´ì!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">ct</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
<span class="p">[(</span><span class="s">"scaling"</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="p">[</span><span class="s">'age'</span><span class="p">,</span> <span class="s">'hours-per-week'</span><span class="p">]),</span>
 <span class="p">(</span><span class="s">"onehot"</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span> <span class="o">=</span> <span class="bp">False</span><span class="p">),</span> <span class="p">[</span><span class="s">'workclass'</span><span class="p">,</span> <span class="s">'education'</span><span class="p">,</span> <span class="s">'gender'</span><span class="p">,</span> <span class="s">'occupation'</span><span class="p">])])</span>
</code></pre></div></div>

<p>ì—¬ê¸°ì„œ â€œscalingâ€ê³¼ â€œonehotâ€ì´ <code class="language-plaintext highlighter-rouge">ì´ë¦„</code>ì— í•´ë‹¹í•˜ë©°, StandardScalerì™€ OneHotEncdoerê°€ <code class="language-plaintext highlighter-rouge">ë³€í™˜ê¸° ê°ì²´</code>ì— í•´ë‹¹í•œë‹¤. ë‹¤ë¥¸ scikit-learnì˜ ë³€í™˜ê¸°ë“¤ê³¼ ë™ì¼í•˜ê²Œ <code class="language-plaintext highlighter-rouge">ColumnTransformer</code>ë¡œ ìƒì„±ëœ ê°ì²´ ë˜í•œ <code class="language-plaintext highlighter-rouge">fit</code>, <code class="language-plaintext highlighter-rouge">transform</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p>ì´ì œ ì´ë¥¼ ì´ìš©í•˜ì—¬ ëª¨ë¸ì„ í•™ìŠµì‹œì¼œë³´ì!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># incomeì„ ì œì™¸í•œ ëª¨ë“  ì—´ì„ ì¶”ì¶œí•œë‹¤. (drop ê¸°ì–µí•´ë‘ì ì€ê·¼ ë§ì´ ì¨ë¨¹ì„ ê²ƒ ê°™ë‹¤.)
</span><span class="n">data_features</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">"income"</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># ë°ì´í„°í”„ë ˆì„ê³¼ incomì„ ë¶„í• í•œë‹¤.
</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_features</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s">'income'</span><span class="p">],</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># ColumnTransformerë¡œ ìƒì„±ëœ ê°ì²´ ì ìš©
</span><span class="n">ct</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_trans</span> <span class="o">=</span> <span class="n">ct</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># ê²°ê³¼ í™•ì¸
</span><span class="k">print</span><span class="p">(</span><span class="n">X_train_trans</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train_trans</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(24420, 44)
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>40</th>
      <th>41</th>
      <th>42</th>
      <th>43</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.498941</td>
      <td>-0.445097</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.380451</td>
      <td>-1.668489</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.250134</td>
      <td>-0.037300</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.925213</td>
      <td>-0.037300</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.543971</td>
      <td>-0.037300</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>24415</th>
      <td>0.323594</td>
      <td>-0.037300</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24416</th>
      <td>0.397053</td>
      <td>-0.445097</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24417</th>
      <td>-1.145591</td>
      <td>-0.037300</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24418</th>
      <td>0.470512</td>
      <td>0.370498</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24419</th>
      <td>-0.998672</td>
      <td>0.615176</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>24420 rows Ã— 44 columns</p>
</div>

<p>ì´ì „ì— í•´ë‹¹ ë°ì´í„°í”„ë ˆì„ì— <code class="language-plaintext highlighter-rouge">get_dummies</code>ë¥¼ ì‚¬ìš©í–ˆì„ ë•Œ ì²˜ëŸ¼ 44ê°œì˜ íŠ¹ì„±ì„ ë°˜í™˜í•˜ì˜€ë‹¤. <code class="language-plaintext highlighter-rouge">get_dummies</code>ì™€ ë‹¬ë¼ì§„ ì ì€ ì—°ì†í˜• íŠ¹ì„±ì„ ê°€ì§„ ì—´ì— ë‹¤ë¥¸ ìŠ¤ì¼€ì¼ë§ ë³€í™˜ì´ ë™ì‹œì— ì ìš©ë˜ì—ˆë‹¤ëŠ” ì ì´ë‹¤.</p>

<p><br /></p>

<p>ì´ì œ LogisticRegressionëª¨ë¸ì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¡œ ë³€í™˜ë˜ì—ˆìœ¼ë‹ˆ ì ìš©í•´ë³´ì!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë¡œì§€ìŠ¤í‹±íšŒê·€ ëª¨ë¸ í•™ìŠµ
</span><span class="n">logreg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">logreg</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_trans</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">X_test_trans</span> <span class="o">=</span> <span class="n">ct</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"í…ŒìŠ¤íŠ¸ ì ìˆ˜ : {:.2f}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">logreg</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_trans</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>í…ŒìŠ¤íŠ¸ ì ìˆ˜ : 0.81
</code></pre></div></div>

<p>(í•´ë‹¹ ë°ì´í„°ì—ì„œëŠ” ì—°ì†í˜• ë³€ìˆ˜ì˜ ë°ì´í„° ìŠ¤ì¼€ì¼ë§ì´ ì ìˆ˜ì— í¬ê²Œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ëŠ” ëª»í–ˆë‹¤ã… .ã… )</p>

<p><br /></p>

<hr />

<h4 id="2-1-make_column_transformerë¡œ-ê°„í¸í•˜ê²Œ-columntransformer-ë§Œë“¤ê¸°">2-1) <u>make_column_transformerë¡œ ê°„í¸í•˜ê²Œ ColumnTransformer ë§Œë“¤ê¸°</u></h4>

<p>ì½”ë”©ì„ í•˜ê±°ë‚˜ ì¼ì„ í•˜ë‹¤ë³´ë©´ ìˆœê°„ ë©ˆì¹«í•˜ëŠ” ìˆœê°„ì´ ë³€ìˆ˜ì˜ ì´ë¦„ì„ ì§“ëŠ” ìˆœê°„ì´ë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ, <code class="language-plaintext highlighter-rouge">ColumnTransformer</code> ê°ì²´ë¥¼ ì •ì˜í•  ë•Œ ì´ë¦„ì„ ë¶™ì˜€ì—ˆë‹¤. í•˜ì§€ë§Œ í´ë˜ìŠ¤ ì´ë¦„ì„ ê¸°ë°˜ìœ¼ë¡œ ìë™ìœ¼ë¡œ ê° ë‹¨ê³„ì— ì´ë¦„ì„ ë¶™ì—¬ì£¼ëŠ” í¸ë¦¬í•œ <code class="language-plaintext highlighter-rouge">make_column_transformer</code>í•¨ìˆ˜ê°€ ìˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">make_column_transformer</span>
<span class="n">ct</span> <span class="o">=</span> <span class="n">make_column_transformer</span><span class="p">(</span>
    <span class="p">(</span><span class="n">StandardScaler</span><span class="p">(),</span> <span class="p">[</span><span class="s">'age'</span><span class="p">,</span> <span class="s">'hours-per-week'</span><span class="p">]),</span>
    <span class="p">(</span><span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span> <span class="p">[</span><span class="s">'workclass'</span><span class="p">,</span> <span class="s">'education'</span><span class="p">,</span> <span class="s">'gender'</span><span class="p">,</span> <span class="s">'occupation'</span><span class="p">]))</span>

<span class="c1"># ColumnTransformerë¡œ ìƒì„±ëœ ê°ì²´ ì ìš©
</span><span class="n">ct</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train_trans</span> <span class="o">=</span> <span class="n">ct</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># ê²°ê³¼ í™•ì¸
</span><span class="k">print</span><span class="p">(</span><span class="n">X_train_trans</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train_trans</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(24420, 44)
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>34</th>
      <th>35</th>
      <th>36</th>
      <th>37</th>
      <th>38</th>
      <th>39</th>
      <th>40</th>
      <th>41</th>
      <th>42</th>
      <th>43</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.498941</td>
      <td>-0.445097</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.380451</td>
      <td>-1.668489</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.250134</td>
      <td>-0.037300</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.925213</td>
      <td>-0.037300</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.543971</td>
      <td>-0.037300</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>24415</th>
      <td>0.323594</td>
      <td>-0.037300</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24416</th>
      <td>0.397053</td>
      <td>-0.445097</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24417</th>
      <td>-1.145591</td>
      <td>-0.037300</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24418</th>
      <td>0.470512</td>
      <td>0.370498</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24419</th>
      <td>-0.998672</td>
      <td>0.615176</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>24420 rows Ã— 44 columns</p>
</div>

<p><br /></p>

<hr />

<h3 id="references">References</h3>

<ul>
  <li>ì•ˆë“œë ˆì•„ìŠ¤ ë®ëŸ¬, ì„¸ë¼ ê°€ì´ë„, ã€íŒŒì´ì¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•œ ë¨¸ì‹ ëŸ¬ë‹ã€, ë°•í•´ì„ , í•œë¹›ë¯¸ë””ì–´(2017)</li>
</ul>

:ET
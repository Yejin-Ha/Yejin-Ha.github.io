I"²{<h4 id="contents">Contents</h4>
<ul>
  <li><a href="#map-ë©”ì†Œë“œ">map ë©”ì†Œë“œ</a></li>
  <li><a href="#apply-ë©”ì†Œë“œ">apply ë©”ì†Œë“œ</a>
    <ul>
      <li><a href="#2-1-apply-ë©”ì†Œë“œ-in-series">2-1) apply ë©”ì†Œë“œ in Series</a></li>
      <li><a href="#2-2-apply-ë©”ì†Œë“œ-in-dataframe">2-2) apply ë©”ì†Œë“œ in DataFrame</a>
        <ul>
          <li><a href="#2-2-1-when-axis0">2-2-1) when axis=0</a></li>
          <li><a href="#2-2-2-when-axis1">2-2-2) when axis=1</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>ë³¸ í¬ìŠ¤íŒ…ì€ <code class="language-plaintext highlighter-rouge">pandas</code>ì˜ <code class="language-plaintext highlighter-rouge">map</code>ê³¼ <code class="language-plaintext highlighter-rouge">apply</code>ë©”ì†Œë“œì— ê´€í•œ ë‚´ìš©ì„ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<hr />

<p>íŒŒì´ì¬ì˜ ë‚´ì¥ í•¨ìˆ˜ì—ëŠ” listì™€ ê°™ì€ iterableê°ì²´ì˜ ê° ì›ì†Œë¥¼ ë§¤í•‘ í•¨ìˆ˜ì— ëŒ€ì…í•˜ì—¬ ê° ì›ì†Œì— ëŒ€í•˜ì—¬ ê²°ê³¼ê°’ì„ ì¶œë ¥í•˜ëŠ” <code class="language-plaintext highlighter-rouge">map</code>í•¨ìˆ˜ê°€ ì¡´ì¬í•œë‹¤. ì´ì™€ ë™ì¼í•˜ê²Œ pandasì˜ Seriesì™€  DataFrameê°ì²´ì—ë„ <code class="language-plaintext highlighter-rouge">map</code>, <code class="language-plaintext highlighter-rouge">apply</code>, <code class="language-plaintext highlighter-rouge">applymap</code>, ê·¸ë¦¬ê³  <code class="language-plaintext highlighter-rouge">pipe</code>ì™€ ê°™ì´ ë§¤í•‘ì„ ìœ„í•œ ë©”ì†Œë“œë“¤ì´ ì¡´ì¬í•œë‹¤. ì˜¤ëŠ˜ì€ ì´ì¤‘ <code class="language-plaintext highlighter-rouge">map</code>ê³¼ <code class="language-plaintext highlighter-rouge">apply</code> ëŒ€í•´ ì •ë¦¬í•´ ë³´ê³ ì í•œë‹¤.</p>

<p><br /></p>

<hr />

<h2 id="map-ë©”ì†Œë“œ"><span style="color:navy">map ë©”ì†Œë“œ<span></span></span></h2>

<p>ì—¬ê¸°ì„œ ì„¤ëª…í•˜ëŠ” <code class="language-plaintext highlighter-rouge">map</code>ë©”ì†Œë“œëŠ” íŒŒì´ì¬ ë‚´ì¥ í•¨ìˆ˜ì˜ <code class="language-plaintext highlighter-rouge">map</code>ê³¼ëŠ” ë‹¤ë¥´ì§€ë§Œ, ê¸°ëŠ¥ì€ ê±°ì˜ ë¹„ìŠ·í•˜ë‹¤. ì´ ë©”ì†Œë“œëŠ” Series í´ë˜ìŠ¤ ê°ì²´ì—ì„œ ì´ìš© ê°€ëŠ¥í•œ ë©”ì†Œë“œì´ë‹¤. ë”°ë¼ì„œ, DataFrame ê°ì²´ì—ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.</p>

<p>í•´ë‹¹ í•¨ìˆ˜ì˜ ê¸°ë³¸ format ë¶€í„° ê°„ë‹¨íˆ ì§šê³  ê°€ë„ë¡ í•˜ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">series</span> <span class="n">ê°ì²´</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">arg</code> : ë§¤í•‘ í•¨ìˆ˜</li>
</ul>

<p><br /></p>

<p>ë‹¤ìŒì€ Seriesê°ì²´ì˜ ê° ì›ì†Œì— 10ì„ ê³±í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§¤í•‘í•˜ëŠ” ì˜ˆì œì´ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sr0</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">map_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">10</span>
<span class="n">mapped_sr</span> <span class="o">=</span> <span class="n">sr</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="n">map_func</span><span class="p">)</span>

<span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'origin'</span><span class="p">:</span> <span class="n">sr</span><span class="p">,</span> <span class="s">'after_map'</span><span class="p">:</span> <span class="n">mapped_sr</span><span class="p">})</span> <span class="c1"># ë¹„êµ
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   origin  after_map
0       1         10
1       2         20
2       3         30
</code></pre></div></div>

<p><br /></p>

<hr />

<h2 id="apply-ë©”ì†Œë“œ"><span style="color:navy">apply ë©”ì†Œë“œ<span></span></span></h2>

<p><code class="language-plaintext highlighter-rouge">apply</code>ë©”ì†Œë“œëŠ” Seriesê°ì²´ì™€ DataFrameê°ì²´ì— ëª¨ë‘ ì¡´ì¬í•œë‹¤. Seriesì—ì„œì˜ <code class="language-plaintext highlighter-rouge">apply</code>ëŠ” ìœ„ì—ì„œ í™•ì¸í•œ <code class="language-plaintext highlighter-rouge">map</code>ë©”ì†Œë“œì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ì§€ë§Œ, <code class="language-plaintext highlighter-rouge">map</code>ê³¼ ë‹¬ë¦¬ í•¨ìˆ˜ì— ë³„ê°œì˜ ì¸ìë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤ëŠ” í° ì¥ì ì„ ê°€ì§„ë‹¤. ë¬¼ë¡  ì´ëŠ” DataFrameê°ì²´ì—ì„œë„ ë§ˆì°¬ê°€ì§€ì´ë‹¤.</p>

<p><br /></p>

<h3 id="2-1-apply-ë©”ì†Œë“œ-in-series"><span style="color:navy">2-1) apply ë©”ì†Œë“œ in Series<span></span></span></h3>

<p>ë‹¤ìŒì€ Seriesì˜ applyë©”ì†Œë“œì˜ ê¸°ë³¸ formatì´ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">Series</span> <span class="n">ê°ì²´</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">mapping_func</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">mapping_func</code> : ë§¤í•‘ í•¨ìˆ˜</li>
  <li><code class="language-plaintext highlighter-rouge">args=(), **kwargs</code> : í•¨ìˆ˜ì— ì „ë‹¬í•  ì¸ì, ì¸ì ì „ë‹¬ ë°©ì‹ì€ ê¸°ë³¸ í•¨ìˆ˜ì™€ ë™ì¼í•˜ë‹¤. ë”°ë¼ì„œ unpackage, package, ê·¸ë¦¬ê³  key: value ë°©ì‹ ë“± í¸í•œ ë°©ë²•ìœ¼ë¡œ ì´ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.</li>
</ul>

<p><br /></p>

<p>ë‹¤ìŒì€ Seriesê°ì²´ì˜ <code class="language-plaintext highlighter-rouge">apply</code>ë©”ì†Œë“œ ì‚¬ìš© ì˜ˆì œì´ë‹¤. <code class="language-plaintext highlighter-rouge">map</code>ë©”ì†Œë“œë¥¼ ë³´ëŠ” ê³¼ì •ì—ì„œ ëŒ€ëµì ì¸ ë§¤í•‘í•¨ìˆ˜ ì§€ì • ë° ì„ ì–¸ ë°©ë²•ì€ í™•ì¸í•˜ì˜€ê¸°ì— ì˜ˆì œì—ì„œëŠ” í•¨ìˆ˜ì— ì¸ìë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ë²•ë“¤ì— ê´€í•´ì„œ ì´ˆì ì„ ë‘ì—ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sr1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">apply_sr_func0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">arg1</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s">'</span>

<span class="k">print</span><span class="p">(</span><span class="n">sr1</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">apply_sr_func0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sr1</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">apply_sr_func0</span><span class="p">,</span> <span class="n">arg1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">arg2</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">apply_sr_func1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s">, '</span> <span class="o">+</span> <span class="s">'{arg1}, {arg2}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">sr1</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">apply_sr_func1</span><span class="p">,</span> <span class="n">arg1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">arg2</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0    1, 1, 3
1    2, 1, 3
2    3, 1, 3
dtype: object 

0    1, 1, 3
1    2, 1, 3
2    3, 1, 3
dtype: object 

0    1, 1, 3
1    2, 1, 3
2    3, 1, 3
dtype: object
</code></pre></div></div>

<p><br /></p>

<h3 id="2-2-apply-ë©”ì†Œë“œ-in-dataframe"><span style="color:navy">2-2) apply ë©”ì†Œë“œ in DataFrame<span></span></span></h3>

<p>DataFrameì˜ <code class="language-plaintext highlighter-rouge">apply</code>ë©”ì†Œë“œì˜ ê¸°ë³¸ formatì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">DataFrame</span> <span class="n">ê°ì²´</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">mapping_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">result_type</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">mapping_func</code> : ë§¤í•‘ í•¨ìˆ˜</li>
  <li><code class="language-plaintext highlighter-rouge">axis</code>
    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">axis=0</code></p>

        <p>ë§¤í•‘ í•¨ìˆ˜ë¥¼ DataFrameì˜ ê° columnë‹¨ìœ„ì— ì ìš©í•œë‹¤. ë§¤í•‘ í•¨ìˆ˜ì— ì „ë‹¬ëœ ê° columnì˜ ë¦¬í„´ê°’ì€ Seriesí˜•íƒœë¡œ ë°˜í™˜ë˜ë©°, ëª¨ë“  columnì— ëŒ€í•´ì„œ ë°˜í™˜ëœ Seriesê°€ ìµœì¢…ì ìœ¼ë¡œ DataFrameìœ¼ë¡œ í†µí•©ë˜ëŠ” ê³¼ì •ì„ ìˆ˜í–‰í•œë‹¤.</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">axis=1</code></p>

        <p>ë§¤í•‘ í•¨ìˆ˜ë¥¼ DataFrameì˜ ê° rowë‹¨ìœ„ì— ì ìš©í•œë‹¤. ë§¤í•‘ í•¨ìˆ˜ì— ê° rowê°€ ì „ë‹¬ë˜ë©°, DataFrameì˜ í–‰ indexê°€ Seriesì˜ indexê°€ ë˜ê³ , í•¨ìˆ˜ê°€ ì ìš©ë˜ì–´ ë¦¬í„´ëœ ê°’ì€ Seriesì˜ valueê°€ ëœë‹¤.</p>
      </li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">result_type</code>
    <ul>
      <li>axis=1ì¼ ë•Œ, ì¦‰ rowë‹¨ìœ„ì—ì„œë§Œ ë§¤í•‘í•¨ìˆ˜ë¥¼ ì ìš©í–ˆì„ ë•Œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì˜µì…˜ì´ë‹¤.</li>
      <li><code class="language-plaintext highlighter-rouge">expand</code> : ê²°ê³¼ columnìœ¼ë¡œ ë°˜í™˜í•˜ê³  ê¸°ì¡´ DataFrameì— ê²°ê³¼ columnì„ í™•ì¥ì‹œí‚¨ë‹¤.</li>
      <li><code class="language-plaintext highlighter-rouge">broadcast</code> : mappingëœ ê²°ê³¼ë¥¼ ê¸°ì¡´ column í˜•ì‹ëŒ€ë¡œ í™•ì¥í•œë‹¤.</li>
      <li>ê¸°ë³¸ê°’ì€ Noneì´ë‹¤.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">args=(), **kwargs</code> : Seriesì˜ applyì™€ ë™ì¼</li>
</ul>

<p><br /></p>

<h4 id="2-2-1-when-axis0"><span style="color:navy">2-2-1) When axis=0<span></span></span></h4>

<p>DataFrameì— <code class="language-plaintext highlighter-rouge">apply</code>ë©”ì†Œë“œì˜ <code class="language-plaintext highlighter-rouge">axis=0</code>ì¼ ë•ŒëŠ” ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë“¯ì´ columnë‹¨ìœ„ì— ë§¤í•‘ í•¨ìˆ˜ê°€ ì ìš©ëœë‹¤. ê·¸ë¦¬ê³ , <code class="language-plaintext highlighter-rouge">axis=0</code>ì¼ ë•Œ, ë§¤í•‘ë˜ëŠ” í•¨ìˆ˜ê°€ ë°˜í™˜ë˜ëŠ” ê°’ì— ë”°ë¼ì„œ <code class="language-plaintext highlighter-rouge">apply</code>ë©”ì†Œë“œì˜ ë°˜í™˜ íƒ€ì…ì´ ë‹¤ë¥´ë‹¤.</p>

<p>ì˜ˆë¥¼ ë“¤ì–´, <code class="language-plaintext highlighter-rouge">axis=0</code>ì¼ ë•Œ, ë§¤í•‘í•¨ìˆ˜ê°€ Seriesë¥¼ ë°˜í™˜í•˜ëŠ” ê²½ìš°ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ DataFrameì„ ë°˜í™˜í•œë‹¤. 
<img src="https://user-images.githubusercontent.com/53929665/155876330-d03a48ac-8ddf-4d0d-937c-fb257adfd3b2.png" alt="Untitled" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span>
                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'col1'</span><span class="p">,</span> <span class="s">'col2'</span><span class="p">,</span> <span class="s">'col3'</span><span class="p">],</span>
                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'row1'</span><span class="p">,</span> <span class="s">'row2'</span><span class="p">,</span> <span class="s">'row3'</span><span class="p">])</span>

<span class="n">axis0_df0</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[ ì‹œë¦¬ì¦ˆë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§¤í•‘í–ˆì„ ë•Œ ]"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">axis0_df0</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ ì‹œë¦¬ì¦ˆë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§¤í•‘í–ˆì„ ë•Œ ]
       col1   col2   col3
row1  False  False  False
row2  False  False  False
row3  False  False  False
</code></pre></div></div>

<p><br /></p>

<p>ë°˜ë©´, í•˜ë‚˜ì˜ ê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ê°€ ë§¤í•‘í•¨ìˆ˜ì— ì‚¬ìš©ë  ê²½ìš°ì—ëŠ” ì•„ë˜ì™€ ê°™ì´ Seriesë¥¼ ë°˜í™˜í•œë‹¤.
<img src="https://user-images.githubusercontent.com/53929665/155876328-598bc4ab-c638-4669-83f3-b0dff7dc5e67.png" alt="Untitled 1" /></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">axis0_df1</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[ í•˜ë‚˜ì˜ ê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§¤í•‘í–ˆì„ ë•Œ ]"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">axis0_df1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ í•˜ë‚˜ì˜ ê°’ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§¤í•‘í–ˆì„ ë•Œ ]
col1    12
col2    15
col3    18
dtype: int64
</code></pre></div></div>

<p><br /></p>

<h4 id="2-2-2-when-axis1"><span style="color:navy">2-2-2) When axis=1<span></span></span></h4>

<p>DataFrameì˜ <code class="language-plaintext highlighter-rouge">apply</code>ë©”ì†Œë“œì˜ <code class="language-plaintext highlighter-rouge">axis=1</code>ì¼ ë•ŒëŠ” rowë‹¨ìœ„ë¡œ ë§¤í•‘í•¨ìˆ˜ê°€ ì ìš©ëœë‹¤. <code class="language-plaintext highlighter-rouge">axis =1</code>ì¼ ë•Œ, ì‹œë¦¬ì¦ˆë¥¼ ë°˜í™˜í•˜ëŠ” ë§¤í•‘í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ê²½ìš°ì—ëŠ” <code class="language-plaintext highlighter-rouge">axis=0</code>ì¼ ë•Œì™€ í° ì°¨ì´ê°€ ì—†ë‹¤. í•˜ì§€ë§Œ, <strong>í•˜ë‚˜ì˜ ê°’ì„ ë°˜í™˜í•˜ëŠ” ë§¤í•‘í•¨ìˆ˜</strong>ê°€ ì‚¬ìš©ë  ê²½ìš°ì—ëŠ” ê° í–‰ì˜ ìš”ì†Œë¥¼ ë§¤í•‘í•¨ìˆ˜ì— ì „ë‹¬í•˜ì—¬ ì–»ì€ ê°’ì´ í–‰ë§ˆë‹¤ ë¦¬í„´ëœë‹¤.</p>

<p>ë‹¤ìŒì€ <code class="language-plaintext highlighter-rouge">apply</code>ë©”ì†Œë“œê°€ <code class="language-plaintext highlighter-rouge">axis=1</code>ì¼ ë•Œì˜ ì˜ˆì œì´ë‹¤.
<img src="https://user-images.githubusercontent.com/53929665/155876329-bfbe5317-48cd-4b8b-b3f9-8236111fa80c.png" alt="Untitled 2" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span>
                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'col1'</span><span class="p">,</span> <span class="s">'col2'</span><span class="p">,</span> <span class="s">'col3'</span><span class="p">],</span>
                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'row1'</span><span class="p">,</span> <span class="s">'row2'</span><span class="p">,</span> <span class="s">'row3'</span><span class="p">])</span>

<span class="n">axis1_df0</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">axis1_df0</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>row1     6
row2    15
row3    24
dtype: int64
</code></pre></div></div>

<p><br /></p>

<p>ì´ì œ <code class="language-plaintext highlighter-rouge">return_type</code>íŒŒë¼ë¯¸í„°ì— ë”°ë¥¸ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ë„ë¡ í•˜ì.</p>

<p><code class="language-plaintext highlighter-rouge">return_type=â€™expandâ€™</code>ëŠ” DataFrameì˜ columnì´ í™•ì¥ë˜ëŠ” ì¼€ì´ìŠ¤ì—ì„œ í™œìš©í•˜ê¸°ì— ë§¤ìš° ìœ ìš©í•˜ë‹¤.</p>

<p>ë¨¼ì €, ë‹¤ìŒ ì½”ë“œëŠ” ë‘ ê°œì˜ ë°˜í™˜ ê²°ê³¼ë¥¼ ë‹´ê³  ìˆëŠ” tupleì— ëŒ€í•œ Seriesë¥¼ DataFrameìœ¼ë¡œ ì¹˜í™˜í•˜ì—¬ ì›ë³¸ DataFrameì— ì¶”ê°€í•˜ëŠ” 3ë‹¨ê³„ì˜ ê³¼ì •ì„ ìˆ˜í–‰í•œë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]],</span>
                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'col1'</span><span class="p">,</span> <span class="s">'col2'</span><span class="p">],</span>
                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'row1'</span><span class="p">,</span> <span class="s">'row2'</span><span class="p">,</span> <span class="s">'row3'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">_add_mul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">arg1</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="n">arg2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">arg1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">arg2</span><span class="p">])</span>

<span class="c1"># Seriesë°˜í™˜
</span><span class="n">result_df</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">_add_mul</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s">'col1'</span><span class="p">,</span> <span class="s">'col2'</span><span class="p">))</span>
<span class="c1"># ë°˜í™˜ëœ Seriesë¥¼ DataFrameìœ¼ë¡œ ë³€í™˜
</span><span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">result_df</span><span class="p">.</span><span class="n">values</span><span class="p">],</span> 
                        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'add'</span><span class="p">,</span> <span class="s">'mul'</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span> <span class="n">result_df</span><span class="p">.</span><span class="n">index</span><span class="p">)</span>
<span class="c1"># ë³€í™˜ì‹œí‚¨ DataFrameì„ ê¸°ì¡´ DataFrameì— ì¶”ê°€
</span><span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">test_df</span><span class="p">,</span> <span class="n">result_df</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">result_df</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      col1  col2  add  mul
row1     1     2    3    2
row2     4     5    9   20
row3     7     8   15   56
</code></pre></div></div>

<p><br /></p>

<p>í•˜ì§€ë§Œ, <code class="language-plaintext highlighter-rouge">result_type</code>ì— <code class="language-plaintext highlighter-rouge">â€˜expandâ€™</code>ë¥¼ ì‚¬ìš©í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ê°„ê²°í•˜ê²Œ í•´ê²°í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]],</span>
                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'col1'</span><span class="p">,</span> <span class="s">'col2'</span><span class="p">],</span>
                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'row1'</span><span class="p">,</span> <span class="s">'row2'</span><span class="p">,</span> <span class="s">'row3'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">_add_mul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">arg1</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="n">arg2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">arg1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">arg2</span><span class="p">])</span>

<span class="n">test_df</span><span class="p">[[</span><span class="s">'sum'</span><span class="p">,</span> <span class="s">'mul'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">_add_mul</span><span class="p">,</span> 
                                    <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s">'col1'</span><span class="p">,</span> <span class="s">'col2'</span><span class="p">),</span> 
                                    <span class="n">result_type</span><span class="o">=</span><span class="s">'expand'</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      col1  col2  sum  mul
row1     1     2    3    2
row2     4     5    9   20
row3     7     8   15   56
</code></pre></div></div>

<p><br /></p>

<p>ë‹¤ìŒì€ <code class="language-plaintext highlighter-rouge">result_type</code>ì´ <code class="language-plaintext highlighter-rouge">'broadcast'</code>ë¡œ ì§€ì •ëœ ê²½ìš°ì´ë‹¤. í•´ë‹¹ ì˜µì…˜ì„ ì§€ì •í–ˆì„ ê²½ìš°ì—ëŠ” ë§¤í•‘í•¨ìˆ˜ë¥¼ í†µí•´ì„œ ë°˜ë“œì‹œ ë‹¨ì¼ ê²°ê³¼ë¡œ ì´ë£¨ì–´ì§„ Seriesê°ì²´ê°€ ë°˜í™˜ë˜ì–´ì•¼í•œë‹¤. ê·¸ë¦¬ê³ , ì´ë ‡ê²Œ ë°˜í™˜ëœ SeriesëŠ” ì›ë³¸ DataFrameì˜ ì—´ í˜•ì‹ëŒ€ë¡œ ì•„ë˜ì™€ ê°™ì´ í™•ì¥ëœë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]],</span>
                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'col1'</span><span class="p">,</span> <span class="s">'col2'</span><span class="p">],</span>
                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'row1'</span><span class="p">,</span> <span class="s">'row2'</span><span class="p">,</span> <span class="s">'row3'</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="s">'[ ì›ë³¸ ]</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">test_df</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">'[ broadcast apply ê²°ê³¼ ]</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">test_df</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">result_type</span> <span class="o">=</span> <span class="s">'broadcast'</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ ì›ë³¸ ]
       col1  col2
row1     1     2
row2     4     5
row3     7     8

[ broadcast apply ê²°ê³¼ ]
       col1  col2
row1     3     3
row2     9     9
row3    15    15
</code></pre></div></div>

<p><br /></p>

<hr />

<h2 id="references"><span style="color:navy">References<span></span></span></h2>

<ul>
  <li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.map.html">pandas doc : pandas.Series.map</a></li>
  <li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.apply.html?highlight=apply#pandas.Series.apply">pandas doc : pandas.Series.apply</a></li>
  <li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html?highlight=apply#pandas.DataFrame.apply">pandas doc : pandas.DataFrame.apply</a></li>
  <li>ì˜¤ìŠ¹í™˜, ã€íŒŒì´ì¬ ë¨¸ì‹ ëŸ¬ë‹ íŒë‹¤ìŠ¤ ë°ì´í„° ë¶„ì„ã€, ì •ë³´ë¬¸í™”ì‚¬ (2019)</li>
</ul>
:ET
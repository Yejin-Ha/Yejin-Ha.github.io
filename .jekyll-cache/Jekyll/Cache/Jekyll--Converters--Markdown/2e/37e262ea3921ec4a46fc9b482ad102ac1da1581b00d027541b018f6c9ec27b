I"Q<h4 id="contents">Contents</h4>
<ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#triggerdagrunoperatorì˜-formatê³¼-parameter">TriggerDagRunOperatorì˜ Formatê³¼ Parameter</a></li>
  <li><a href="#ì‚¬ìš©-ì˜ˆì œ">ì‚¬ìš© ì˜ˆì œ</a></li>
</ul>

<p>ë³¸ í¬ìŠ¤íŒ…ì€ ì¹´í…Œê³ ë¦¬ Airflowì˜  TriggerDagRunOperatorì— ê´€í•˜ì—¬ ì •ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<hr />

<h2 id="introudction"><span style="color:navy">Introudction<span></span></span></h2>

<p><a href="https://jhryu1208.github.io/data/2022/02/20/Airflow_ExternalTaskSensor/">ì§€ë‚œ í¬ìŠ¤íŒ…</a>ì— ì´ì–´ì„œ <code class="language-plaintext highlighter-rouge">TriggerDagRunOperator</code>ì— ëŒ€í•´ ì•Œì•„ë³´ê³ ì í•œë‹¤. <br /> (ë°”ë¡œ ë ˆê³ ë ˆê³  ğŸƒğŸ’¨ğŸ’¨)</p>

<p><br /></p>

<hr />

<h2 id="triggerdagrunoperatorì˜-formatê³¼-parameter"><span style="color:navy">TriggerDagRunOperatorì˜ Formatê³¼ Parameter<span></span></span></h2>

<p>ì•„ë˜ëŠ” <code class="language-plaintext highlighter-rouge">TriggerDagRunOperator</code>ì˜ ê¸°ë³¸ í¬ë§·ê³¼ íŒŒë¼ë¯¸í„°ì— ê´€í•´ì„œ ë³´ì—¬ì¤€ë‹¤.  ë‚˜ì˜ ê²½ìš° Airflow ë²„ì „1ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë²„ì „1ì„ ì´ˆì ì— ë§ì¶”ì–´ ë‚´ìš©ì„ ì •ë¦¬í•˜ì˜€ë‹¤. (í¸ì˜ìƒ Trigger ë‹¹í•˜ëŠ” ì™¸ë¶€ Dagë¥¼ Slave Dag, ê·¸ë¦¬ê³  Triggerì„ ìˆ˜í–‰í•˜ëŠ” Dagë¥¼ Master Dagë¼ê³  ì¹­í•˜ê² ë‹¤.)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">task</span> <span class="o">=</span> <span class="n">TriggerDagRunOperator</span><span class="p">(</span><span class="s">'task_name_example'</span><span class="p">,</span>
                             <span class="n">trigger_dag_id</span> <span class="o">=</span> <span class="s">'slave_dag_id'</span><span class="p">,</span>
                             <span class="n">python_callable</span> <span class="o">=</span> <span class="n">tirgger_something_func</span><span class="p">,</span>
                             <span class="n">execution_date</span> <span class="o">=</span> <span class="s">''</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">trigger_dag_id</code> (<em>str</em>)
    <ul>
      <li>triggerí•  Slave Dagì˜ <code class="language-plaintext highlighter-rouge">dag_id</code>ë¥¼ ë°›ëŠ”ë‹¤. ì°¸ê³ ë¡œ, Slave Dagì˜ tirggerëŠ” Master Dagê°€ ëŒ€ì‹ í•˜ê¸° ë•Œë¬¸ì— schedule_interval=Noneìœ¼ë¡œ ì§€ì •í•´ë„ ê´œì°®ë‹¤.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">python_callable</code> (<em>python callable</em>)
    <ul>
      <li>Airflowì˜ XComê³¼ ë¹„ìŠ·í•œ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ì§€ë§Œ,  XComì˜ ê²½ìš° ë™ì¼ Dagì— ìˆëŠ” Taskë¼ë¦¬ë§Œ ê°€ëŠ¥í•˜ë‹¤. í•˜ì§€ë§Œ, í•´ë‹¹ íŒŒë¼ë¯¸í„°ë¥¼ ì´ìš©í•  ê²½ìš° Master Dagì—ì„œ Slave Dagë¡œì˜ ë‹¨ë°©í–¥ ê°ì²´ ì „ë‹¬ì„ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.</li>
      <li>í•´ë‹¹ íŒŒë¦¬ë¯¸í„°ì— ì „ë‹¬ë˜ëŠ” ê°ì²´ëŠ” <code class="language-plaintext highlighter-rouge">context object</code>ì™€ <code class="language-plaintext highlighter-rouge">placeholder object</code>(<code class="language-plaintext highlighter-rouge">obj</code>)ë¥¼ ë°›ëŠ” í•¨ìˆ˜ì´ë©°, ì´ í•¨ìˆ˜ëŠ” <code class="language-plaintext highlighter-rouge">obj</code>ë¥¼ ë°˜í™˜í•´ì•¼í•œë‹¤. <code class="language-plaintext highlighter-rouge">obj</code>ì—ëŠ” ì»¤ìŠ¤í…€í•  ìˆ˜ ìˆëŠ” <code class="language-plaintext highlighter-rouge">run_id</code>ì™€ <code class="language-plaintext highlighter-rouge">payload</code>ì†ì„±ì´ ì¡´ì¬í•œë‹¤.</li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">run_id</code>ì†ì„±ì˜ ê²½ìš° Slave Dag Runì„ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ì•„ë˜ì™€ ê°™ì€ ê°’ì¸ë° ì§ì ‘ì ìœ¼ë¡œ íŠ¸ë™í‚¹í•˜ê¸° ì–´ë ¤ì›Œì„œ user defineìœ¼ë¡œ ê°’ì„ ì£¼ê¸° ìœ„í•´ì„œëŠ” ì‹¤ì œë¡œëŠ” ì»¤ìŠ¤í…€ í•¨ìˆ˜ê°€ ë³„ë„ë¡œ í•„ìš”í•  ê²ƒ ê°™ë‹¤. ë‚˜ì˜ ê²½ìš°ì—ëŠ” ì´ìš©í•˜ì§€ ì•Šì„ ê²ƒ ê°™ë‹¤.</p>

        <p><img src="https://user-images.githubusercontent.com/53929665/154988161-cd5e9331-b611-4a1f-8d35-ac401be5eabe.png" alt="Untitled" /></p>
      </li>
      <li><code class="language-plaintext highlighter-rouge">payload</code>ì†ì„±ì€ ë‹¤ë¥¸ Dagì— ì „ë‹¬í•  serializationê°€ëŠ¥í•œ <code class="language-plaintext highlighter-rouge">pickable object</code>ë¥¼ í•´ë‹¹ íŒŒë¼ë¯¸í„°ëŠ” ì „ë‹¬ ë°›ëŠ”ë‹¤. ê·¸ë¦¬ê³  ì´ë¥¼ ì „ë‹¬ ë°›ì€ Slave Dagì˜ TaskëŠ” <code class="language-plaintext highlighter-rouge">context object</code>ì˜ <code class="language-plaintext highlighter-rouge">dag_run</code> keyì˜ valueì˜ <code class="language-plaintext highlighter-rouge">conf</code>ì†ì„±ìœ¼ë¡œ ë¶€í„° í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤. (ì¦‰, <code class="language-plaintext highlighter-rouge">context[â€™dag_runâ€™].conf</code> )</li>
      <li>
        <p>ë”°ë¼ì„œ ì—¬ê¸°ì— ì „ë‹¬ë˜ëŠ” í•¨ìˆ˜ì˜ ê¸°ë³¸ í¬ë§·ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">test_func</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
          <span class="n">obj</span><span class="p">.</span><span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s">"key"</span><span class="p">:</span> <span class="s">"value"</span><span class="p">}</span>
          <span class="k">return</span> <span class="n">obj</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">execution_date</code> (<em>str/datetime.datetime</em>)
    <ul>
      <li>Slave Dagì˜ execution dateë¥¼ ë°›ëŠ”ë‹¤.</li>
      <li>Master Dagê°€ ì™„ë£Œë˜ê³  ë‚œ ë’¤ì— ë°”ë¡œ Slave Dagê°€ ìˆ˜í–‰ë˜ê¸°ë¥¼ ì›í•œë‹¤ë©´ ê³ ë ¤í•  í•„ìš”ëŠ” ì—†ë‹¤.</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<hr />

<h2 id="ì‚¬ìš©-ì˜ˆì œ"><span style="color:navy">ì‚¬ìš© ì˜ˆì œ<span></span></span></h2>

<p>ë‹¤ìŒì€ slave dag ì½”ë“œì™€ slave dagë¥¼ tirggerì‹œí‚¤ëŠ” master dagì— ëŒ€í•œ ì½”ë“œì´ë‹¤.</p>

<p>master dagì˜ dag_idëŠ” <strong>Master_Dag_for_TDR</strong>ì´ë¼ê³  ì§€ì •í•˜ì˜€ìœ¼ë©°, slave dagì˜ dag_idëŠ” <strong>Slave_Dag_for_TDR</strong>ì´ë¼ê³  ì§€ì •í•˜ì˜€ë‹¤. ë”ë¶ˆì–´, tirggerë‹¹í•˜ëŠ” slave dagì˜ ê²½ìš° <code class="language-plaintext highlighter-rouge">schedule_interval</code>ê°€ <code class="language-plaintext highlighter-rouge">None</code>ìœ¼ë¡œ ì§€ì •í•˜ì˜€ë‹¤.</p>

<h5 id="-trigger_master_dagpy">&lt;/&gt; trigger_master_dag.py</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">airflow.models</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="kn">from</span> <span class="nn">airflow.operators.dummy_operator</span> <span class="kn">import</span> <span class="n">DummyOperator</span>
<span class="kn">from</span> <span class="nn">airflow.operators.python_operator</span> <span class="kn">import</span> <span class="n">PythonOperator</span>
<span class="kn">from</span> <span class="nn">airflow.operators.dagrun_operator</span> <span class="kn">import</span> <span class="n">TriggerDagRunOperator</span>

<span class="n">default_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'owner'</span><span class="p">:</span> <span class="s">'zaid.ryu'</span>
<span class="p">}</span>

<span class="n">dag</span> <span class="o">=</span> <span class="n">DAG</span><span class="p">(</span><span class="s">'Master_Dag_for_TDR'</span><span class="p">,</span>
          <span class="n">description</span> <span class="o">=</span> <span class="s">'Master Dag'</span><span class="p">,</span>
          <span class="n">schedule_interval</span> <span class="o">=</span> <span class="s">'0 17 * * *'</span><span class="p">,</span>
          <span class="n">default_args</span> <span class="o">=</span> <span class="n">default_args</span><span class="p">,</span>
          <span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span>
          <span class="n">catchup</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">trigger_func</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="n">obj</span><span class="p">.</span><span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s">'name'</span><span class="p">:</span><span class="s">'Zaid.Ryu'</span><span class="p">,</span>
                   <span class="s">'talk'</span><span class="p">:</span><span class="s">'this is my first code for TriggerDagRunOperator'</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">obj</span>

<span class="k">def</span> <span class="nf">print_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'ds : </span><span class="si">{</span><span class="n">ds</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

<span class="n">m_task1</span> <span class="o">=</span> <span class="n">DummyOperator</span><span class="p">(</span><span class="n">task_id</span> <span class="o">=</span> <span class="s">'master_task'</span><span class="p">,</span>
                        <span class="n">dag</span> <span class="o">=</span> <span class="n">dag</span><span class="p">)</span>

<span class="n">m_task2</span> <span class="o">=</span> <span class="n">TriggerDagRunOperator</span><span class="p">(</span><span class="n">task_id</span> <span class="o">=</span> <span class="s">'trigger_slave'</span><span class="p">,</span>
                                <span class="n">trigger_dag_id</span> <span class="o">=</span> <span class="s">'Slave_Dag_for_TDR'</span><span class="p">,</span>
                                <span class="n">python_callable</span> <span class="o">=</span> <span class="n">trigger_func</span><span class="p">,</span>
                                <span class="n">execution_date</span> <span class="o">=</span> <span class="s">""</span><span class="p">,</span>
                                <span class="n">dag</span> <span class="o">=</span> <span class="n">dag</span><span class="p">)</span>

<span class="n">m_task3</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span><span class="n">task_id</span> <span class="o">=</span> <span class="s">'printDS'</span><span class="p">,</span>
                         <span class="n">python_callable</span> <span class="o">=</span> <span class="n">print_ds</span><span class="p">,</span>
                         <span class="n">op_args</span><span class="o">=</span><span class="p">[</span><span class="s">""</span><span class="p">],</span>
                         <span class="n">dag</span> <span class="o">=</span> <span class="n">dag</span><span class="p">)</span>

<span class="n">m_task1</span> <span class="o">&gt;&gt;</span> <span class="n">m_task2</span> <span class="o">&gt;&gt;</span> <span class="n">m_task3</span>
</code></pre></div></div>

<h5 id="-trigger_slave_dagpy">&lt;/&gt; trigger_slave_dag.py</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">airflow.models</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="kn">from</span> <span class="nn">airflow.operators.dummy_operator</span> <span class="kn">import</span> <span class="n">DummyOperator</span>
<span class="kn">from</span> <span class="nn">airflow.operators.python_operator</span> <span class="kn">import</span> <span class="n">PythonOperator</span>

<span class="n">default_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'owner'</span><span class="p">:</span> <span class="s">'zaid.ryu'</span>
<span class="p">}</span>

<span class="n">dag</span> <span class="o">=</span> <span class="n">DAG</span><span class="p">(</span><span class="s">'Slave_Dag_for_TDR'</span><span class="p">,</span>
          <span class="n">description</span> <span class="o">=</span> <span class="s">'Slave Dag'</span><span class="p">,</span>
          <span class="n">schedule_interval</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
          <span class="n">default_args</span><span class="o">=</span><span class="n">default_args</span><span class="p">,</span>
          <span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span>
          <span class="n">catchup</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">pirnt_conf</span><span class="p">(</span><span class="o">**</span><span class="n">context</span><span class="p">):</span>
    <span class="n">dag_run</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s">'dag_run'</span><span class="p">].</span><span class="n">conf</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'{name} said </span><span class="se">\"</span><span class="s">{talk}</span><span class="se">\"</span><span class="s">'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="o">**</span><span class="n">dag_run</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">print_ds</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'ds : </span><span class="si">{</span><span class="n">ds</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

<span class="n">s_task1</span> <span class="o">=</span> <span class="n">DummyOperator</span><span class="p">(</span><span class="n">task_id</span> <span class="o">=</span> <span class="s">'slave_task'</span><span class="p">,</span>
                        <span class="n">dag</span> <span class="o">=</span> <span class="n">dag</span><span class="p">)</span>

<span class="n">s_task2</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span><span class="n">task_id</span> <span class="o">=</span> <span class="s">'printDagRun'</span><span class="p">,</span>
                         <span class="n">python_callable</span><span class="o">=</span><span class="n">pirnt_conf</span><span class="p">,</span>
                         <span class="n">provide_context</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                         <span class="n">dag</span> <span class="o">=</span> <span class="n">dag</span><span class="p">)</span>

<span class="n">s_task3</span> <span class="o">=</span> <span class="n">PythonOperator</span><span class="p">(</span><span class="n">task_id</span> <span class="o">=</span> <span class="s">'printDS'</span><span class="p">,</span>
                         <span class="n">python_callable</span> <span class="o">=</span> <span class="n">print_ds</span><span class="p">,</span>
                         <span class="n">op_args</span><span class="o">=</span><span class="p">[</span><span class="s">""</span><span class="p">],</span>
                         <span class="n">dag</span> <span class="o">=</span> <span class="n">dag</span><span class="p">)</span>

<span class="n">s_task1</span> <span class="o">&gt;&gt;</span> <span class="n">s_task2</span> <span class="o">&gt;&gt;</span> <span class="n">s_task3</span>
</code></pre></div></div>

<p><br /></p>

<p>ê·¸ë¦¬ê³  ì´ë¥¼ ì‹¤í–‰í–ˆì„ ë•Œì˜ dag ê´€ê³„ë¥¼ ë„ì‹í™”í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì´ë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/53929665/154988151-994e654b-780e-4cbe-ba48-b329117e98db.png" alt="Untitled 1" /></p>

<p>ìœ„ì˜ ê·¸ë¦¼ì˜ ì§ì‚¬ê°í˜•ì€ Taskë¥¼ ì˜ë¯¸í•˜ë©° ì¤„ ì„ ìœ¼ë¡œ ë¬¶ì–´ Dagì•ˆì— í¬í•¨ë˜ì—ˆìŒì„ í‘œí˜„í•˜ì˜€ë‹¤. í•´ë‹¹ ê·¸ë¦¼ì„ ê¸°ì¤€ìœ¼ë¡œ master dagëŠ” ì‹¤í–‰ ì¤‘ì¸ ìƒíƒœì´ë©°, master_taskê¹Œì§€ ìˆ˜í–‰ì´ ì™„ë£Œë˜ì—ˆìŒì„ í‘œì‹œí•˜ì˜€ë‹¤. ê·¸ë¦¬ê³ , í™”ì‚´í‘œì˜ ê²½ìš° tirgger ê´€ê³„ë¥¼ í‘œì‹œí•œë‹¤.</p>

<p>í•´ë‹¹ ê·¸ë¦¼ì€ í˜„ì¬ master dagê°€ runì¸ ìƒíƒœì´ë©°, master_taskê¹Œì§€ ìˆ˜í–‰ ì™„ë£Œí•˜ì˜€ìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ, slave dagëŠ” run ìƒíƒœì— í•´ë‹¹í•˜ì§€ ì•Šìœ¼ë©° ìŠ¤ì¼€ì¤„ì—…ëœ ìƒíƒœë„ ì•„ë‹Œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì´ì œ master dagì˜ trigger_slaveê°€ scheduledìƒíƒœê°€ ëœ ë‹¤ìŒì„ í™•ì¸í•´ë³´ì.</p>

<p><br /></p>

<p><img src="https://user-images.githubusercontent.com/53929665/154988153-4dc4cd3f-6ad3-4a72-bb94-edec409f7439.png" alt="Untitled 2" /></p>

<p>master dagì˜ trigger_slaveê°€ ìˆ˜í–‰ë˜ë©´ì„œ ì½”ë“œì—ì„œ ì§€ì •í•œ slave dagê°€ ìˆ˜í–‰ ìƒíƒœì— ì§„ì…í•œ ê²ƒì„ í™•ì¸í•˜ì˜€ë‹¤. ì´ë•Œ, tirgger_slaveì˜ ì‹œì‘ ì‹œê°„, ì¢…ë£Œì‹œê°„, ê·¸ë¦¬ê³  slave dagì˜ ì‹œì‘ ì‹œê°„ì„ ë¹„êµí•´ë³´ë©´ tirgger_slaveê°€ ìˆ˜í–‰ì´ ëë‚œ ë’¤ì— slave_dagê°€ tirggerë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, trigger_slaveê°€ ì‹œì‘ë˜ë©´ì„œ slave_dagê°€ ìˆ˜í–‰ë˜ëŠ” ê²ƒì„ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<h5 id="-trigger_master_dagpyì˜-trigger_func-í•¨ìˆ˜">&lt;/&gt; trigger_master_dag.pyì˜ trigger_func í•¨ìˆ˜</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">trigger_func</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="n">obj</span><span class="p">.</span><span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s">'name'</span><span class="p">:</span><span class="s">'Zaid.Ryu'</span><span class="p">,</span>
                   <span class="s">'talk'</span><span class="p">:</span><span class="s">'this is my first code for TriggerDagRunOperator'</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">obj</span>
</code></pre></div></div>

<h5 id="-trigger_slave_dagpyì˜-print_confí•¨ìˆ˜">&lt;/&gt; trigger_slave_dag.pyì˜ print_confí•¨ìˆ˜</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">print_conf</span><span class="p">(</span><span class="o">**</span><span class="n">context</span><span class="p">):</span>
    <span class="n">dag_run</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s">'dag_run'</span><span class="p">].</span><span class="n">conf</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'{name} said </span><span class="se">\"</span><span class="s">{talk}</span><span class="se">\"</span><span class="s">'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="o">**</span><span class="n">dag_run</span><span class="p">))</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/53929665/154988157-aa9af60a-1740-4486-b1c6-0ce1654351ae.png" alt="Untitled 3" /></p>

<p>ê·¸ë¦¬ê³ ,  slave dagì˜ printDagRun Taskì˜ logì—ì„œ trigger_funcí•¨ìˆ˜ë¥¼ í†µí•´ì„œ master dagê°€ slave dagì— ë³´ë‚¸ objectë¥¼ slave dagì˜ <code class="language-plaintext highlighter-rouge">context obj</code>ì—ì„œ ì •ìƒì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.</p>

<p><br /></p>

<hr />

<h2 id="references">References</h2>

<ul>
  <li><a href="https://airflow.apache.org/docs/apache-airflow/1.10.15/_api/airflow/operators/dagrun_operator/index.html?highlight=triggerdagrunoperator#airflow.operators.dagrun_operator.TriggerDagRunOperator">Airflow version1 : dagrun_operator.TriggerDagRunOperator</a></li>
  <li><a href="https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/trigger_dagrun/index.html">Airflow version2 : trigger_dagrun.TriggerDagRunOperator</a></li>
</ul>
:ET
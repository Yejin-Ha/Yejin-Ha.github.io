I"°<h4 id="ml-with-python-2-ì§€ë„-í•™ìŠµ-ì•Œê³ ë¦¬ì¦˜-6-2-ì‹ ê²½ë§-ëª¨ë¸mlp-ì‹ ê²½ë§-íŠœë‹">[ML with Python] 2. ì§€ë„ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ (6-2) ì‹ ê²½ë§ ëª¨ë¸(MLP ì‹ ê²½ë§ íŠœë‹)</h4>
<ul>
  <li>ë³¸ í¬ìŠ¤íŒ…ì€ ì§€ë„ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì¸ ì‹ ê²½ë§ ëª¨ë¸ì— ê´€í•œ ê¸°ë³¸ì ì¸ ë‚´ìš©ì— ê´€í•˜ì—¬ ë‹¤ë£¹ë‹ˆë‹¤.</li>
  <li>ë‹¤ì¸µ í¼ì…‰íŠ¸ë¡ (<code class="language-plaintext highlighter-rouge">multilayer perceptrons, MLP</code>)</li>
  <li>ì‹ ê²½ë§ íŠœë‹</li>
  <li>ì‹ ê²½ë§ ì¥ë‹¨ì </li>
  <li>ì‹ ê²½ë§ì˜ ë³µì¡ë„ ì¶”ì •</li>
</ul>

<hr />

<p>í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ import</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">mglearn</span>
<span class="kn">import</span> <span class="nn">graphviz</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_moons</span>
</code></pre></div></div>

<hr />

<h4 id="ì‹ ê²½ë§-íŠœë‹"><u>ì‹ ê²½ë§ íŠœë‹</u></h4>

<p><a href="https://jhryu1208.github.io/data/2020/11/24/ML_Neural-Network/">ì´ì „ í¬ìŠ¤íŒ…</a>ì—ì„œ ê³µë¶€í•œ <code class="language-plaintext highlighter-rouge">ë‹¤ì¸µ í¼ì…‰íŠ¸ë¡ (MLP)</code>ì„ two_moons ë°ì´í„°ì…‹ì— ì ìš©í•˜ë©° ëª¨ë¸ì„ ì´í•´í•´ë³´ì.</p>

<p><br /></p>

<p>ì§„í–‰ì „ <code class="language-plaintext highlighter-rouge">MLP</code>ë¥¼ êµ¬í˜„í•˜ëŠ” <code class="language-plaintext highlighter-rouge">MLPClassifier</code>ì˜ ì‹ ê²½ë§ì˜ ë³µì¡ë„ë¥¼ ì œì–´í•  ìˆ˜ ìˆëŠ” ë§¤ê°œë³€ìˆ˜ì— ê´€í•˜ì—¬ ë¨¼ì € ì‚´í´ë³´ê² ë‹¤.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">hidden_layer_sizes</code>
    <ul>
      <li>ì€ë‹‰ì¶©ì˜ ìˆ˜ì™€ ë‰´ëŸ°ì˜ ê°¯ìˆ˜ë¥¼ ì¡°ì ˆí•˜ëŠ” ë§¤ê°œë³€ìˆ˜</li>
      <li>defaultê°’ì€ (100, )ì´ë‹¤.</li>
      <li>ex) 10ê°œì˜ ì€ë‹‰ ìœ ë‹›ìœ¼ë¡œ êµ¬ì„±ëœ 2ê°œì˜ ì€ë‹‰ì¸µì„ êµ¬ì„±í•˜ê³  ì‹¶ì„ ê²½ìš° =&gt; hidden_layer_sizes=(10,10)</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">activation</code>
    <ul>
      <li>í™œì„±í™” í•¨ìˆ˜ë¥¼ ì§€ì •í•˜ëŠ” ë§¤ê°œë³€ìˆ˜</li>
      <li>ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ : <code class="language-plaintext highlighter-rouge">logistic</code><br />ë ë£¨ í•¨ìˆ˜ : <code class="language-plaintext highlighter-rouge">relu</code>(defaultê°’)<br />í•˜ì´í¼ë³¼ë¦­ íƒ„ì  íŠ¸ í•¨ìˆ˜ : <code class="language-plaintext highlighter-rouge">tanh</code></li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">alpha</code>
    <ul>
      <li>L2ê·œì œë¥¼ ì ìš©í•˜ê¸° ìœ„í•œ ë§¤ê°œë³€ìˆ˜</li>
      <li>defaultê°’ì€ 0.0001ì´ë‹¤.</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">batch_size</code>, <code class="language-plaintext highlighter-rouge">learning_rate_init</code>, <code class="language-plaintext highlighter-rouge">max_iter</code> ë“±ì˜ ë§¤ê°œë³€ìˆ˜ë„ ì¡´ì¬í•œë‹¤.<br />ë˜í•œ <code class="language-plaintext highlighter-rouge">solver</code>ë§¤ê°œë³€ìˆ˜ë„ ìˆìœ¼ë©°, ì´ì— ê´€í•´ì„œëŠ” ë§ˆì§€ë§‰ì— ì‚´í´ë³¼ ì˜ˆì •ì´ë‹¤.</li>
</ul>

<p>ì´ì²˜ëŸ¼ <code class="language-plaintext highlighter-rouge">MLPClassifier</code>ëŠ” ë§ì€ ë§¤ê°œë³€ìˆ˜ë“¤ì„ ê°€ì§€ê³  ìˆë‹¤.</p>

<p><br /></p>

<p>ì´ì œ two_moons ë°ì´í„°ì…‹ì— ì ìš©í•´ë³´ì.<br />
ì€ë‹‰ ìœ ë‹›ì˜ ê°¯ìˆ˜ëŠ” ë”°ë¡œ ì„¤ì •í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ì€ë‹‰ ìœ ë‹›ì˜ ìˆ˜ëŠ” ê¸°ë³¸ê°’ì¸ 100ê°œì´ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_moons</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_moons</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                                                    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'lbfgs'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">mglearn</span><span class="p">.</span><span class="n">plots</span><span class="p">.</span><span class="n">plot_2d_separator</span><span class="p">(</span><span class="n">mlp</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span>
<span class="n">mglearn</span><span class="p">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"property 0"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"property 1"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0, 0.5, 'property 1')
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/53929665/100255934-79791180-2f87-11eb-8b5c-3b79016f4ce7.png" alt="ML_Neural-Network-tunning_3_1" /></p>

<p><code class="language-plaintext highlighter-rouge">MLP</code>ì‹ ê²½ë§ ëª¨ë¸ì€ ì´ì™€ ê°™ì´ ë§¤ìš° <code class="language-plaintext highlighter-rouge">ë¹„ì„ í˜•ì ì¸</code> ëª¨ë¸ì„ ë§Œë“¤ì—ˆìœ¼ë©°, ë¹„êµì  ë§¤ë„ëŸ¬ìš´ ê²°ì • ê²½ê³„ì˜ í˜•íƒœë¥¼ ë§Œë“¤ì—ˆë‹¤.</p>

<p><br /></p>

<p>ìœ„ì—ì„œëŠ” ì€ë‹‰ ìœ ë‹›ì˜ ê°¯ìˆ˜ë¥¼ ê¸°ë³¸ê°’ì¸ 100ìœ¼ë¡œ ì„¤ì •í•˜ì˜€ë‹¤. ì´ëŠ” two_moons ë°ì´í„°ì…‹ê³¼ ê°™ì´ ì‘ì€ ë°ì´í„°ì…‹ì—ì„œëŠ” ê³¼ë¶„í•œ í¬ê¸°ì´ë‹¤. í•´ë‹¹ ë°ì´í„°ì…‹ì—ì„œëŠ” ìœ ë‹›ì˜ ê°œìˆ˜ë¥¼ ì¤„ì—¬ë„ ë‹¤ìŒê³¼ ê°™ì´ ì—¬ì „íˆ ì¢‹ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì€ë‹‰ ìœ ë‹›ì„ 10ê°œë¡œ ê°ì†Œì‹œì¼°ë‹¤.
</span><span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'lbfgs'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
<span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">mglearn</span><span class="p">.</span><span class="n">plots</span><span class="p">.</span><span class="n">plot_2d_separator</span><span class="p">(</span><span class="n">mlp</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span>
<span class="n">mglearn</span><span class="p">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"property 0"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"property 1"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\Users\jhryu\AppData\Local\Programs\Python\Python37\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:471: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
  self.n_iter_ = _check_optimize_result("lbfgs", opt_res, self.max_iter)





Text(0, 0.5, 'property 1')
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/53929665/100255935-7a11a800-2f87-11eb-894f-c32c72111967.png" alt="ML_Neural-Network-tunning_5_2" /></p>

<p><br /></p>

<p><u>ë” ë§¤ë„ëŸ¬ìš´ ê²°ì • ê²½ê³„ë¥¼ ì›í•  ê²½ìš°</u> ë‹¤ìŒê³¼ ê°™ì€ ë§¤ê°œë³€ìˆ˜ ì¡°ì •ì„ ìƒê°í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
  <li>ì€ë‹‰ ìœ ë‹› ì¶”ê°€</li>
  <li>ì€ë‹‰ì¸µ ì¶”ê°€</li>
  <li>tanh í•¨ìˆ˜ ì‚¬ìš©</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 10ê°œì˜ ìœ ë‹›ìœ¼ë¡œ ëœ ë‘ ê°œì˜ ì€ë‹‰ì¸µ
</span><span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'lbfgs'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">mglearn</span><span class="p">.</span><span class="n">plots</span><span class="p">.</span><span class="n">plot_2d_separator</span><span class="p">(</span><span class="n">mlp</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span>
<span class="n">mglearn</span><span class="p">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"property 0"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"property 1"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0, 0.5, 'property 1')
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/53929665/100255937-7a11a800-2f87-11eb-81c3-0c108637b58b.png" alt="ML_Neural-Network-tunning_7_1" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># tanh í™œì„±í™” í•¨ìˆ˜ê°€ ì ìš©
# 10ê°œì˜ ìœ ë‹›ìœ¼ë¡œ ëœ ë‘ ê°œì˜ ì€ë‹‰ì¸µ
</span><span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'lbfgs'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'tanh'</span><span class="p">,</span>
                    <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">mglearn</span><span class="p">.</span><span class="n">plots</span><span class="p">.</span><span class="n">plot_2d_separator</span><span class="p">(</span><span class="n">mlp</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span>
<span class="n">mglearn</span><span class="p">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"property 0"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"property 1"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0, 0.5, 'property 1')
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/53929665/100255938-7aaa3e80-2f87-11eb-8a14-91f3b94ab790.png" alt="ML_Neural-Network-tunning_8_2" /></p>

<p><br /></p>

<p><code class="language-plaintext highlighter-rouge">MLP</code>ì‹ ê²½ë§ ëª¨ë¸ë„ <code class="language-plaintext highlighter-rouge">ë¦¬ì§€ íšŒê·€</code>ì—ì„œ ì²˜ëŸ¼ <code class="language-plaintext highlighter-rouge">L2íŒ¨ë„í‹°</code>ë¥¼ ì‚¬ìš©í•´ ê°€ì¤‘ì¹˜ë¥¼ 0ì— ê°€ê¹ê²Œ ê°ì†Œì‹œì¼œ ëª¨ë¸ì˜ ë³µì¡ë„ë¥¼ ì œì–´í•  ìˆ˜ ìˆë‹¤. <code class="language-plaintext highlighter-rouge">MLPClassifier</code>ì—ì„œ ì´ì™€ ê°™ì€ ì—­í• ì„ í•˜ëŠ” ë§¤ê°œë³€ìˆ˜ëŠ” ì•ì—ì„œ ë³´ì•˜ë˜ <code class="language-plaintext highlighter-rouge">alpha(ê¸°ë³¸ê°’ : 0.0001)</code>ì´ë‹¤. ë‹¤ìŒ ê·¸ë¦¼ì€ two_moonsë°ì´í„°ì…‹ì— ìœ ë‹›ì´ ê°ê° 10ê°œì™€ 100ê°œì¸ ì€ë‹‰ì¸µ 2ê°œë¥¼ ì‚¬ìš©í–ˆì„ ë–„ ë‹¤ë¥¸ alphaê°’ì´ ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ë³´ì—¬ì¤€ë‹¤. <code class="language-plaintext highlighter-rouge">alpha</code>ë§¤ê°œë³€ìˆ˜ê°€ ì»¤ì§ˆìˆ˜ë¡ ì œì–´ë ¥ì´ ê°•í•´ì ¸ì„œ ë³µì¡ë„ê°€ ë‚®ì•„ì§€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">axx</span><span class="p">,</span> <span class="n">n_hidden_nodes</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axx</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]):</span>
        <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'lbfgs'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                            <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="n">n_hidden_nodes</span><span class="p">,</span> <span class="n">n_hidden_nodes</span><span class="p">],</span>
                            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">mglearn</span><span class="p">.</span><span class="n">plots</span><span class="p">.</span><span class="n">plot_2d_separator</span><span class="p">(</span><span class="n">mlp</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">mglearn</span><span class="p">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"n_hidden=[{}, {}]</span><span class="se">\n</span><span class="s">alpha={:.4f}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span>
                      <span class="n">n_hidden_nodes</span><span class="p">,</span> <span class="n">n_hidden_nodes</span><span class="p">,</span> <span class="n">alpha</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
  self.n_iter_ = _check_optimize_result("lbfgs", opt_res, self.max_iter)
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/53929665/100255940-7aaa3e80-2f87-11eb-8a72-a84a2b80fb6e.png" alt="ML_Neural-Network-tunning_10_1" /></p>

<p><br /></p>

<p>ë˜í•œ, ì‹ ê²½ë§ì—ì„œëŠ” í•™ìŠµì„ ì§„í–‰í•˜ê¸° ì „ì— <code class="language-plaintext highlighter-rouge">ê°€ì¤‘ì¹˜</code>ë¥¼ <b>ë¬´ì‘ìœ„</b>ë¡œ ì„¤ì •í•œë‹¤. ì´ ë¬´ì‘ìœ„í•œ ì´ˆê¸°í™”ëŠ” ëª¨ë¸ì˜ í•™ìŠµì— ì˜í–¥ì„ ì¤€ë‹¤. ë”°ë¼ì„œ, ê°™ì€ ë§¤ê°œë³€ìˆ˜ë¥¼ ì ìš©í•˜ë”ë¼ë„ ì´ˆê¹ƒê°’ì´ ë‹¤ë¥´ë©´ ëª¨ë¸ì´ ë§ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤. <b>ì‹ ê²½ë§ì´ í´ ê²½ìš°</b>ì´ëŸ° ë¬¸ì œëŠ” í¬ì§€ ì•Šì§€ë§Œ, <b>ì‹ ê²½ë§ì´ ì‘ì„ ê²½ìš°</b>(ex.two_moons ë°ì´í„°ì…‹)ê³¼ ê°™ì€ ê²½ìš° ê°™ì€ ë§¤ê°œë³€ìˆ˜ë¥¼ ê°€ì ¸ë„ ë‹¤ë¥¸ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤.</p>

<p><br /></p>

<p>ë‹¤ìŒì€ ê°™ì€ ë§¤ê°œë³€ìˆ˜ì—ì„œ ë¬´ì‘ìœ„ë¡œ ë‹¤ë¥¸ ì´ˆê¸°ê°’ì´ ì£¼ì–´ì§„ two_moons ë°ì´í„°ì…‹ì—ì„œì˜ í•™ìŠµê²°ê³¼ì´ë‹¤. ê²°ì • ê²½ê³„ê°€ ëª¨ë‘ ë‹¤ë¥¸ ì–‘ìƒì„ ë³´ì—¬ì£¼ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">.</span><span class="n">ravel</span><span class="p">()):</span>
    <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'lbfgs'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                        <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
    <span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">mglearn</span><span class="p">.</span><span class="n">plots</span><span class="p">.</span><span class="n">plot_2d_separator</span><span class="p">(</span><span class="n">mlp</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">mglearn</span><span class="p">.</span><span class="n">discrete_scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/53929665/100255942-7b42d500-2f87-11eb-9161-6144829f773a.png" alt="ML_Neural-Network-tunning_12_0" /></p>

<p><br /></p>

<p>ì‹ ê²½ë§ì„ ë” ì˜ ì´í•´í•˜ê¸° ìœ„í•´ ì‹¤ì œ ë°ì´í„°ì…‹ì¸ ìœ ë°©ì•” ë°ì´í„°ì…‹ì— <code class="language-plaintext highlighter-rouge">MLPClassifier</code>ë¥¼ ì ìš©í•´ë³´ì</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cancer</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"ìœ ë°©ì•” ë°ì´í„°ì˜ íŠ¹ì„±ë³„ ìµœëŒ“ê°’:</span><span class="se">\n</span><span class="s">{}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">cancer</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ìœ ë°©ì•” ë°ì´í„°ì˜ íŠ¹ì„±ë³„ ìµœëŒ“ê°’:
[2.811e+01 3.928e+01 1.885e+02 2.501e+03 1.634e-01 3.454e-01 4.268e-01
 2.012e-01 3.040e-01 9.744e-02 2.873e+00 4.885e+00 2.198e+01 5.422e+02
 3.113e-02 1.354e-01 3.960e-01 5.279e-02 7.895e-02 2.984e-02 3.604e+01
 4.954e+01 2.512e+02 4.254e+03 2.226e-01 1.058e+00 1.252e+00 2.910e-01
 6.638e-01 2.075e-01]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">cancer</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cancer</span><span class="p">.</span><span class="n">target</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"í›ˆë ¨ ì„¸íŠ¸ ì •í™•ë„: {:.2f}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì •í™•ë„: {:.2f}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>í›ˆë ¨ ì„¸íŠ¸ ì •í™•ë„: 0.94
í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì •í™•ë„: 0.92
</code></pre></div></div>

<p>ìœ„ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê²ƒ ì²˜ëŸ¼, <code class="language-plaintext highlighter-rouge">MLP</code>ì˜ ì •í™•ë„ëŠ” ê½¤ ë†’ì§€ë§Œ ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ë‹¤ë¥¸ ëª¨ë¸ë§Œí¼ì€ ì•„ë‹ˆë‹¤.</p>

<p><br /></p>

<p><a href="https://jhryu1208.github.io/data/2020/11/22/ML_SVM/">ì´ì „ì—</a> <code class="language-plaintext highlighter-rouge">SVC</code>ì™€ ê°™ì€ ê²½ìš° <code class="language-plaintext highlighter-rouge">ë°ì´í„°ì˜ ìŠ¤ì¼€ì¼</code>ì´ ì˜í–¥ì„ ë¼ì³¤ì—ˆë‹¤. <u>ë§ˆì°¬ê°€ì§€ë¡œ `ì‹ ê²½ë§`ë„ ëª¨ë“  ì…ë ¥ íŠ¹ì„±ì„ í‰ê· ì€ 0, ë¶„ì‚°ì€ 1ì´ ë˜ë„ë¡ ë³€í˜•í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.</u></p>

<p><br /></p>

<p>ê·¸ëŸ¼ í•´ë‹¹ ì¡°ê±´ì— ë§ë„ë¡ ë°ì´í„°ì˜ ìŠ¤ì¼€ì¼ì„ ì¡°ì •í•˜ê³ , ì •í™•ë„ë¥¼ í™•ì¸í•´ë³´ì</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># í›ˆë ¨ ì„¸íŠ¸ ê° íŠ¹ì„±ì˜ í‰ê· ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
</span><span class="n">mean_on_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># í›ˆë ¨ ì„¸íŠ¸ ê° íŠ¹ì„±ì˜ í‘œì¤€ í¸ì°¨ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
</span><span class="n">std_on_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># ë°ì´í„°ì—ì„œ í‰ê· ì„ ë¹¼ê³  í‘œì¤€ í¸ì°¨ë¡œ ë‚˜ëˆ„ë©´
# í‰ê·  0, í‘œì¤€ í¸ì°¨ 1ì¸ ë°ì´í„°ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.
</span><span class="n">X_train_scaled</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_train</span> <span class="o">-</span> <span class="n">mean_on_train</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_on_train</span>
<span class="c1"># (í›ˆë ¨ ë°ì´í„°ì˜ í‰ê· ê³¼ í‘œì¤€ í¸ì°¨ë¥¼ ì´ìš©í•´) ê°™ì€ ë³€í™˜ì„ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì—ë„ í•©ë‹ˆë‹¤.
</span><span class="n">X_test_scaled</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_test</span> <span class="o">-</span> <span class="n">mean_on_train</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_on_train</span>

<span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"í›ˆë ¨ ì„¸íŠ¸ ì •í™•ë„: {:.3f}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì •í™•ë„: {:.3f}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>í›ˆë ¨ ì„¸íŠ¸ ì •í™•ë„: 0.991
í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì •í™•ë„: 0.965
</code></pre></div></div>

<p>ìŠ¤ì¼€ì¼ì„ ì¡°ì •í•˜ë‹ˆ ê²°ê³¼ê°€ ë§¤ìš° ì¢‹ì•„ì¡Œìœ¼ë©° ë‹¤ë¥¸ ëª¨ë¸ì˜ ì„±ëŠ¥ ëª»ì§€ì•ŠëŠ”ë‹¤. í•˜ì§€ë§Œ, <code class="language-plaintext highlighter-rouge">Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.</code>ë¼ë©° ìµœëŒ€ ë°˜ë³µ íšŸìˆ˜ì— ë„ë‹¬í•˜ì˜€ë‹¤ëŠ” ì˜¤ë¥˜ê°€ ì¶œë ¥ë˜ì—ˆë‹¤. ì´ëŠ” ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ëŠ” <code class="language-plaintext highlighter-rouge">adam</code>ì•Œê³ ë¦¬ì¦˜ì— ê´€ë ¨ëœ ê²ƒìœ¼ë¡œ ì´ ê²½ê³ ê°€ ë‚˜ì˜¤ë©´ ë°˜ë³µ íšŸìˆ˜ë¥¼ ëŠ˜ë ¤ì•¼í•œë‹¤. ë°˜ë³µ íšŸìˆ˜ëŠ” ì•ì—ì„œ í™•ì¸í•˜ì˜€ë˜ ë§¤ê°œë³€ìˆ˜ì¸ <code class="language-plaintext highlighter-rouge">max_iter</code>ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì¡°ì •í•´ì•¼í•œë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"í›ˆë ¨ ì„¸íŠ¸ ì •í™•ë„: {:.3f}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì •í™•ë„: {:.3f}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>í›ˆë ¨ ì„¸íŠ¸ ì •í™•ë„: 1.000
í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì •í™•ë„: 0.972
</code></pre></div></div>

<p>ì˜¤ë¥˜ê°€ ì—†ì–´ì§ˆ ë¿ë”ëŸ¬, ë°˜ë³µ íšŸìˆ˜ë¥¼ ëŠ˜ë ¤ì„œ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ì„±ëŠ¥ì´ ë”ìš± ì¢‹ì•„ì¡Œë‹¤. í•˜ì§€ë§Œ, í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì‚¬ì´ì— ì„±ëŠ¥ ì°¨ì´ê°€ í™•ì¸ë˜ê¸°ì— ì¼ë°˜í™” ì„±ëŠ¥ì„ ë” ì˜¬ë¦¬ê³ ì <code class="language-plaintext highlighter-rouge">alpha</code>ë§¤ê°œë³€ìˆ˜ ê¸°ë³¸ê°’(default = 0.001)ì—ì„œ 1ë¡œ ì¦ê°€ì‹œì¼œ ëª¨ë¸ì˜ ë³µì¡ë„ë¥¼ ì¢€ ë” ë‚®ì¶°ë³´ì.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"í›ˆë ¨ ì„¸íŠ¸ ì •í™•ë„: {:.3f}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì •í™•ë„: {:.3f}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>í›ˆë ¨ ì„¸íŠ¸ ì •í™•ë„: 0.988
í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ ì •í™•ë„: 0.972
</code></pre></div></div>

<p>ë” ì¢‹ì€ ê²°ê³¼ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤!</p>

<p><br /></p>

<p>ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ë¥¼ í™•ì¸í•´ë³´ë©´ ì–´ë–¤ íŠ¹ì„±ì´ í•™ìŠµë˜ì—ˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤. ì•„ë˜ì˜ ê·¸ë¦¼ì€ <code class="language-plaintext highlighter-rouge">ì…ë ¥ì¸µ</code>ê³¼ <code class="language-plaintext highlighter-rouge">ì€ë‹‰ì¶©</code> ì‚¬ì´ì— ìœ„ì¹˜í•œ í•™ìŠµëœ ê°€ì¤‘ì¹˜ë¥¼ ë³´ì—¬ì¤€ë‹¤. ì´ ê·¸ë¦¼ì˜ í–‰ì€ 30ê°œì˜ ì…ë ¥ íŠ¹ì„±ê³¼ 100ê°œì˜ ì€ë‹‰ ìœ ë‹›ì— í•´ë‹¹í•œë‹¤. ë°ì€ ìƒ‰ì€ í° ì–‘ìˆ˜ ê°’, ì–´ë‘ìš´ ìƒ‰ì€ ìŒìˆ˜ ê°’ì„ ì˜ë¯¸í•œë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mlp</span><span class="p">.</span><span class="n">coefs_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">'none'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'viridis'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">cancer</span><span class="p">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"hidden unit"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"input property"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">colorbar</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.colorbar.Colorbar at 0x1f0671e5808&gt;
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/53929665/100255931-7847e480-2f87-11eb-9174-0cb065b784a7.png" alt="ML_Neural-Network-tunning_23_1" /></p>

<p>ëª¨ë“  ì€ë‹‰ ìœ ë‹›ì—ì„œ <code class="language-plaintext highlighter-rouge">ì‘ì€ ê°€ì¤‘ì¹˜</code>ë¥¼ ê°€ì§„ íŠ¹ì„±ì€ <code class="language-plaintext highlighter-rouge">ëœ ì¤‘ìš”í•œ</code> ëª¨ë¸ì´ë¼ëŠ” ê²ƒì„ ì¶”ë¡ í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, â€œsmoothness errorâ€ì™€ â€œfractal dimension errorâ€ ì‚¬ì´ì— ìˆëŠ” íŠ¹ì„±ê³¼ â€œmean smoothnessâ€ì™€ â€œmean compactnessâ€ê°€ ë‹¤ë¥¸ íŠ¹ì„±ë“¤ë³´ë‹¤ ê°€ì¤‘ì¹˜ê°€ ë‚®ë‹¤. ì´ íŠ¹ì„±ë“¤ì€ ëœ ì¤‘ìš”í•˜ê±°ë‚˜ ì‹ ê²½ë§ì—ê²Œ ì ì ˆí•˜ê²Œ ì…ë ¥ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ë„ ìˆë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.</p>

<p><br /></p>

<p><code class="language-plaintext highlighter-rouge">ì€ë‹‰ì¸µ</code>ê³¼ <code class="language-plaintext highlighter-rouge">ì¶œë ¥ì¸µ</code>ì‚¬ì´ì˜ ê°€ì¤‘ì¹˜ë„ ì‹œê°í™” í•  ìˆ˜ ìˆì§€ë§Œ, í•´ì„ì€ ë” ì–´ë µë‹¤.</p>

<p><br /></p>

<hr />

<h4 id="ì¥ë‹¨ì "><u>ì¥ë‹¨ì </u></h4>

<ul>
  <li><b>ì¥ì </b>
    <ul>
      <li>ëŒ€ëŸ‰ì˜ ë°ì´í„°ì— ë‚´ì¬ëœ ì •ë³´ë¥¼ ì¡ì•„ë‚´ê³  <u>ë§¤ìš° ë³µì¡í•œ ëª¨ë¸</u>ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</li>
      <li>ì¶©ë¶„í•œ ì—°ì‚° ì‹œê°„ê³¼ ë°ì´í„°ë¥¼ ì£¼ê³  <u>ë§¤ê°œë³€ìˆ˜ë¥¼ ì„¸ì‹¬í•˜ê²Œ ì¡°ì •</u>í•˜ë©´ ì¢…ì¢… ë‹¤ë¥¸ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ ë›°ì–´ë„˜ëŠ” ì„±ëŠ¥ì„ ë³´ì—¬ì¤€ë‹¤.</li>
    </ul>
  </li>
  <li><b>ë‹¨ì </b>
    <ul>
      <li>ì¢…ì¢… í•™ìŠµì´ ì˜¤ë˜ ê±¸ë¦°ë‹¤.</li>
      <li><code class="language-plaintext highlighter-rouge">ë°ì´í„° ì „ì²˜ë¦¬</code>ì— ì£¼ì˜í•´ì•¼í•œë‹¤! (<code class="language-plaintext highlighter-rouge">SVM</code>ê³¼ ë¹„ìŠ·í•˜ê²Œ ëª¨ë“  íŠ¹ì„±ì´ ê°™ì€ ìŠ¤ì¼€ì¼ì„ ê°€ì§„ ë™ì§ˆì˜ ë°ì´í„°ì—ì„œëŠ” ì˜ ì‘ë™í•œë‹¤. ë‹¤ë¥¸ ì¢…ë¥˜ì˜ íŠ¹ì„±ì´ë¼ë©´ <code class="language-plaintext highlighter-rouge">ê²°ì • íŠ¸ë¦¬</code>ê°€ ë” íš¨ê³¼ì ì¼ ìˆ˜ ìˆë‹¤.)</li>
      <li>ì‹ ê²½ë§ ë§¤ê°œë³€ìˆ˜ íŠœë‹ì€ ì˜ˆìˆ ì— ê°€ê¹Œìš´ ì¼ì´ë‹¤â€¦â€¦</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<hr />

<h4 id="ì‹ ê²½ë§ì˜-ë³µì¡ë„-ì¶”ì •"><u>ì‹ ê²½ë§ì˜ ë³µì¡ë„ ì¶”ì •</u></h4>

<p><b>ì‹ ê²½ë§ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ë§¤ê°œë³€ìˆ˜</b>ëŠ” <code class="language-plaintext highlighter-rouge">ì€ë‹‰ì¸µì˜ ê°œìˆ˜</code>ì™€ <code class="language-plaintext highlighter-rouge">ì€ë‹‰ì¸µì˜ ìœ ë‹› ìˆ˜</code>ì´ë‹¤.<br />
ì²˜ìŒì—” 1~2ê°œì˜ <code class="language-plaintext highlighter-rouge">ì€ë‹‰ì¸µ</code>ì—ì„œ ë¶€í„° ì‹œì‘í•´ì„œ ëŠ˜ë ¤ë‚˜ê°€ì•¼ í•œë‹¤.<br />
<code class="language-plaintext highlighter-rouge">ì€ë‹‰ì¸µì˜ ìœ ë‹› ìˆ˜</code>ì˜ ê²½ìš° ë³´í†µ ì…ë ¥ íŠ¹ì„±ì˜ ìˆ˜ì™€ ë¹„ìŠ·í•˜ê²Œ ì„¤ì •í•œë‹¤. (ìˆ˜ì²œì„ ë„˜ëŠ” ì¼ì€ ê±°ì˜ ì—†ë‹¤.)</p>

<p><br /></p>

<p><u> `ì‹ ê²½ë§`ì˜ ëª¨ë¸ ë³µì¡ë„ì— ê´€í•´ ë„ì›€ì´ ë  ìˆ˜ ìˆëŠ” ì¸¡ì •ì¹˜</u>ëŠ” <code class="language-plaintext highlighter-rouge">í•™ìŠµëœ ê°€ì¤‘ì¹˜</code>ì™€ <code class="language-plaintext highlighter-rouge">ê³„ìˆ˜ì˜ ìˆ˜</code>ì´ë‹¤.</p>

<p><br /></p>

<p><b>ì‹ ê²½ë§ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ì¡°ì •í•˜ëŠ” ì¼ë°˜ì ì¸ ë°©ë²•</b>ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul>
  <li>STEP 1 : ì¶©ë¶„íˆ ê³¼ëŒ€ì í•©ë˜ì–´ì„œ ë¬¸ì œë¥¼ í•´ê²°í• ë§Œí•œ í° ëª¨ë¸ì„ ë§Œë“ ë‹¤.</li>
  <li>STEP 2 : ì‹ ê²½ë§ êµ¬ì¡°ë¥¼ ì¤„ì´ê±°ë‚˜ ê·œì œ ê°•í™”ë¥¼ ìœ„í•´ <code class="language-plaintext highlighter-rouge">alpha</code>ê°’ì„ ì¦ê°€ì‹œì¼œ ì¼ë°˜í™” ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¨ë‹¤.</li>
</ul>

<p><br /></p>

<p>ìœ„ì—ì„œ ë³´ì•˜ë˜ ì˜ˆì œë“¤ì—ì„œëŠ” ëª¨ë¸ì˜ ë§¤ê°œë³€ìˆ˜ êµ¬ì„±ì— ì´ˆì ì„ ë§ì¶”ì–´ ì§„í–‰í–ˆì—ˆë‹¤.<br />
ì´ ì¤‘ <b><code class="language-plaintext highlighter-rouge">solver</code> ë§¤ê°œë³€ìˆ˜</b>ì„ í†µí•´ì„œë„ <u>ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ëŠ” ë°©ë²•</u> ë˜ëŠ” <u>ë§¤ê°œë³€ìˆ˜ í•™ìŠµì— ì‚¬ìš©í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜</u>ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤. <code class="language-plaintext highlighter-rouge">solver</code>ë§¤ê°œë³€ìˆ˜ì—ëŠ” ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë‹¤ìŒì˜ ë‘ ì˜µì…˜ì´ ìˆë‹¤.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">adam</code>
    <ul>
      <li>defaultê°’ ì´ë‹¤.</li>
      <li>ëŒ€ë¶€ë¶„ì˜ ê²½ìš°ì— ì˜ ì‘ë™í•˜ì§€ë§Œ ë°ì´í„°ì˜ ìŠ¤ì¼€ì¼ì— ì¡°ê¸ˆ ë¯¼ê°í•˜ë‹¤.<br />(ë”°ë¼ì„œ, ë°ì´í„°ì˜ í‰ê· ì„ 0 ë¶„ì‚°ì„ 1ë¡œ ì¡°ì •í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.)</li>
      <li><code class="language-plaintext highlighter-rouge">MLP</code>ë¥¼ ì²˜ìŒ ì‚¬ìš©í•  ë•Œ ì¶”ì²œ!</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">lbfgs</code>
    <ul>
      <li>ì•ˆì •ì ì´ë‹¤.</li>
      <li>ê·œëª¨ê°€ í° ëª¨ë¸ì´ë‚˜ ëŒ€ëŸ‰ì˜ ë°ì´í„°ì…‹ì—ì„œëŠ” ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦°ë‹¤.</li>
      <li><code class="language-plaintext highlighter-rouge">MLP</code>ë¥¼ ì²˜ìŒ ì‚¬ìš©í•  ë•Œ ì¶”ì²œ!</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">sgd</code>
    <ul>
      <li>ë”¥ëŸ¬ë‹ì—ì„œ ë§ì´ ì‚¬ìš©ëœë‹¤.</li>
      <li>í•´ë‹¹ ì˜µì…˜ì—ì„œëŠ” ë‹¤ë¥¸ ì—¬ëŸ¬ ë§¤ê°œë³€ìˆ˜ì™€ í•¨ê»˜ íŠœë‹í•˜ì—¬ ìµœì„ ì˜ ê²°ê³¼ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<hr />

<h3 id="references">References</h3>

<ul>
  <li>ì•ˆë“œë ˆì•„ìŠ¤ ë®ëŸ¬, ì„¸ë¼ ê°€ì´ë„, ã€íŒŒì´ì¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•œ ë¨¸ì‹ ëŸ¬ë‹ã€, ë°•í•´ì„ , í•œë¹›ë¯¸ë””ì–´(2017)</li>
  <li><a href="https://machfam.com/16450">ë§ˆí¬íŒ¸:ê³µí•™,í•´ì„,ì½”ë”©ë¸”ë¡œê·¸</a></li>
</ul>

:ET
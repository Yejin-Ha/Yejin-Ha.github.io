I"Üj<h3>Table of Contents<span class="tocSkip"></span></h3>
<div class="toc"><ul class="toc-item"><li><span><a href="#1.-BoW-(-Bag-of-Words-)" data-toc-modified-id="1.-BoW-(-Bag-of-Words-)-1">1. BoW ( Bag-of-Words )</a></span></li><li><span><a href="#2.-bag-of-n-grams" data-toc-modified-id="2.-bag-of-n-grams-2">2. bag-of-n-grams</a></span></li></ul></div>

<p>ë³¸ í¬ìŠ¤íŒ…ì€ ã€Feature Engineering for Machine Learning - PRRINCIPLES AND TECHNIQUES FOR DATA SCIENTISTSã€ì˜ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ êµ¬ì„±í•˜ì˜€ìœ¼ë©° ì €ì˜ ì£¼ê´€ì ì¸ ìƒê°ê³¼ ê²¬í•´ê°€ í•¨ê»˜ ì„œìˆ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì‚¬ì „ ì‘ì—…
</span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">warnings</span><span class="p">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s">'ignore'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'axes.unicode_minus'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span> 
<span class="n">plt</span><span class="p">.</span><span class="n">rc</span><span class="p">(</span><span class="s">'font'</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s">'Malgun Gothic'</span><span class="p">)</span> 
</code></pre></div></div>

<p><br /></p>

<hr />

<h3 id="1-bow--bag-of-words-">1. BoW ( Bag-of-Words )</h3>

<p>ëª¨ë¸ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” ë°ì´í„°ë¥¼ ëª¨ë¸ì— ë§ê²Œ Transformí•´ì•¼ë§Œ í•œë‹¤. ë‹¨ì–´ í…ìŠ¤íŠ¸ì˜ ê²½ìš° ëª¨ë¸ ì•Œê³ ë¦¬ì¦˜ì—ì„œ ìˆëŠ” ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜  ì—†ê¸° ë•Œë¬¸ì— ìˆ«ìê°’ìœ¼ë¡œ í”¼ì³ ë³€í™˜ì„ í•´ì£¼ì–´ì•¼ë§Œ í•œë‹¤. <code class="language-plaintext highlighter-rouge">í…ìŠ¤íŠ¸</code>ì— ê´€í•œ í”¼ì³ ì—”ì§€ë‹ˆì–´ë§ì˜ ì‹œì‘ì€ ë‹¨ì–´ ì¹´ìš´íŠ¸ í†µê³„ë¥¼ ê¸°ì´ˆë¡œí•œ <strong><code class="language-plaintext highlighter-rouge">BoW(Bag-of-Words)</code></strong>ë¡œ ë¶€í„° ì‹œì‘í•œë‹¤.</p>

<p><br /></p>

<p>ê·¸ë ‡ë‹¤ë©´ <code class="language-plaintext highlighter-rouge">BoW</code>ë€ ë¬´ì—‡ì¼ê¹Œ?</p>
<ul>
  <li>BoW í”¼ì²˜ë¥¼ ìƒì„±í•  ë•Œ í…ìŠ¤íŠ¸(Word) ë¬¸ì„œëŠ” <strong>ì¹´ìš´íŠ¸</strong>ë¥¼ ê°€ì§„ <strong>Vectorë¡œ ë³€í™˜(Bagì— ë‹´ê¸°ê²Œ)</strong>ëœë‹¤.
    <ul>
      <li>VectorëŠ” Vocabularyì—ì„œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ëŒ€ë¶€ë¶„ì˜ ë‹¨ì–´ì— ëŒ€í•œ í•­ëª©ì„ ê°€ì§€ê³  ìˆë‹¤.</li>
      <li>ì–´ë–¤ ë¬¸ì¥ì´ Vocabularyì— í•´ë‹¹í•˜ëŠ” ë‹¨ì–´ë¥¼ ê°€ì§€ê³  ìˆë‹¤ë©´ ê·¸ ë‹¨ì–´ì˜ ìˆ«ìë§Œí¼ ì¹´ìš´íŠ¸ëœë‹¤.</li>
      <li>ê°€ì§€ê³  ìˆì§€ ì•Šë‹¤ë©´ ì¹´ìš´íŠ¸ëŠ” 0ì´ë‹¤.</li>
      <li>ì˜ˆì‹œ) ì›ì‹œí…ìŠ¤íŠ¸ : <strong>â€˜it is a puppy and it is extremely cuteâ€™</strong></li>
    </ul>
  </li>
</ul>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>it</th>
      <th>they</th>
      <th>is</th>
      <th>are</th>
      <th>a</th>
      <th>an</th>
      <th>puppy</th>
      <th>cat</th>
      <th>and</th>
      <th>extremely</th>
      <th>cute</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<ul>
  <li>Bow í”¼ì²˜ëŠ” ì‹œí€€ìŠ¤ë¥¼ ê°–ì§€ ì•Šê³ , ë‹¨ìˆœíˆ Wordê°€ Textì— ëª‡ ë²ˆ ë‚˜íƒ€ë‚˜ëŠ”ì§€ í‘œì‹œí•œë‹¤.
    <ul>
      <li>ë”°ë¼ì„œ, <u>ë‹¨ì–´ì˜ ìˆœì„œì™€ ê³„ì¸µ êµ¬ì¡°ë¥¼ ì „í˜€ í‘œí˜„í•˜ì§€ ì•ŠëŠ”ë‹¤</u>.</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<p>ë˜ ë‹¤ë¥¸ <code class="language-plaintext highlighter-rouge">BoW</code>ì˜ ê°€ì¥ ì¤‘ìš”í•œ íŠ¹ì§•ì€ Textì˜ Wordë¥¼ <strong><code class="language-plaintext highlighter-rouge">ê¸°í•˜í•™ì </code></strong>ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤. ë§Œì•½ Vocabularyì— $n$ê°œì˜ ë‹¨ì–´ê°€ ìˆë‹¤ë©´ í•˜ë‚˜ì˜ ë¬¸ì„œëŠ” $n$ì°¨ì› ê³µê°„ì—ì„œ í•˜ë‚˜ì˜ í¬ì¸íŠ¸ê°€ ë˜ëŠ” ê²ƒì´ë‹¤. ë‹¤ìŒì˜ figureëŠ” Textì˜ <strong><code class="language-plaintext highlighter-rouge">Word Vector(ë°ì´í„° ë²¡í„°)</code></strong>ê°€ <strong><code class="language-plaintext highlighter-rouge">í”¼ì²˜ ê³µê°„</code></strong>ì— ì–´ë–»ê²Œ ìœ„ì¹˜ë˜ëŠ”ì§€ ë³´ì—¬ì¤€ë‹¤. (ê° ì¶•ì€ í”¼ì²˜ë¡œì„œ BoWí‘œí˜„ì— ë“¤ì–´ ìˆëŠ” ê°œë³„ ë‹¨ì–´ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.)</p>

<p><img src="https://user-images.githubusercontent.com/53929665/108627156-867aa380-7497-11eb-9cb6-813a2cdb59cc.png" alt="FE_chapter3-1_8_0" /></p>

<p><br /></p>

<p>ì´ì™€ ë°˜ëŒ€ë¡œ <strong><code class="language-plaintext highlighter-rouge">ë°ì´í„° ê³µê°„</code></strong>ì—ì„œì˜ <strong><code class="language-plaintext highlighter-rouge">í”¼ì²˜ ë²¡í„°</code></strong>ë¥¼ ì‚´í´ë³´ëŠ” ê²ƒë„ ìœ ìš©í•˜ë‹¤. ì´ ê²½ìš° í”¼ì²˜ ë²¡í„°ëŠ” ì´ ë‹¨ì–´ì˜ ë¬¸ì„œ ë‚´ ì¹´ìš´íŠ¸ë¥¼ ê°€ì§€ê²Œ ëœë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/53929665/108627157-87133a00-7497-11eb-95b3-dd1dea98cc72.png" alt="FE_chapter3-1_10_0" /></p>

<p><br /></p>

<p>í•˜ì§€ë§Œ, <code class="language-plaintext highlighter-rouge">BoW</code>ëŠ” ì•ì—ì„œ ì–¸ê¸‰í–ˆë“¯ì´ <strong><u>ìˆœì„œ/ê³„ì¸µ êµ¬ì¡°ë¥¼ í‘œí˜„í•˜ì§€ ëª»í•˜ê¸°</u></strong> ë•Œë¬¸ì— <strong><u>(ì¤‘ìš”)Textì˜ ì˜ë¯¸ë¥¼ íŒŒê´´</u></strong>í•œë‹¤ëŠ” ë§¤ìš° í° ë‹¨ì ì„ ê°€ì§€ê³  ìˆë‹¤. ì˜ˆë¥¼ ë“¤ìë©´, â€˜ê°•ì•„ì§€ ì¥ë‚œê°â€™ê³¼ â€˜ê°•ì•„ì§€ ì¥ë‚œê°â€™ì´ë¼ëŠ” ì˜ˆë¥¼ ë“¤ ìˆ˜ ìˆë‹¤. ë‘˜ ë‹¤ ê°•ì•„ì§€ì™€ ì¥ë‚œê°ì´ 1ë¡œ ì¹´ìš´íŠ¸ë˜ëŠ” ê²ƒì€ ë™ì¼í•˜ì§€ë§Œ, ìˆœì„œê°€ ë°”ë€Œì—ˆê¸° ë•Œë¬¸ì— ì˜ë¯¸ê°€ ì™„ì „íˆ ë‹¬ë¼ì§„ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<p>ìœ„ì˜ ë¬¸ì œë¥¼ ì™„í™”í•  ë°©ë²•ì—ëŠ” ì™„ë²½í•œ í•´ê²°ì±…ì€ ì•„ë‹ˆì§€ë§Œ ì‚¬ë„ì— í•´ë‹¹í•˜ëŠ” <strong><code class="language-plaintext highlighter-rouge">bag-of-n-Grams</code></strong>ê°€ ìˆë‹¤.</p>

<p><br /></p>

<hr />

<h3 id="2-bag-of-n-grams">2. bag-of-n-grams</h3>

<p><strong><code class="language-plaintext highlighter-rouge">bag-of-n-grams</code></strong>ë€?</p>
<ul>
  <li>ë¨¼ì € ëˆˆì— ë³´ì´ëŠ” <strong><code class="language-plaintext highlighter-rouge">n-grams</code></strong>ë€ ë¬´ì—‡ì¼ê¹Œ?
    <ul>
      <li>n-grams : $n$ê°œì˜ <strong><u>ì—°ì†ì ìœ¼ë¡œ ë‚˜ì—´</u></strong>ëœ í† í°(í˜¹ì€ ë‹¨ì–´)ì´ë‹¤. corpusì—ì„œ $n$ê°œì˜ ë‹¨ì–´ ë­‰ì¹˜ ë‹¨ìœ„ë¡œ ëŠì–´ì„œ ì´ë¥¼ í•˜ë‚˜ì˜ í† í°ìœ¼ë¡œ ê°„ì£¼í•œë‹¤.
        <ul>
          <li>í•˜ë‚˜ì˜ ë‹¨ì–´ë¡œ êµ¬ì„±ë  ê²½ìš° : 1-gram(í˜¹ì€ unigram)</li>
          <li>ë‘ê°œì˜ ë‹¨ì–´ë¡œ êµ¬ì„±ë  ê²½ìš° : bigram</li>
          <li>ì„¸ê°œì˜ ë‹¨ì–´ë¡œ êµ¬ì„±ë  ê²½ìš° : trigram</li>
          <li>ë„¤ê°œì˜ ë‹¨ì–´ë¡œ êµ¬ì„±ë  ê²½ìš° : 4-grams</li>
        </ul>
      </li>
      <li>ex) â€œI love you foreverâ€ì„ ì˜ˆì‹œë¡œ bigramsë¥¼ êµ¬ì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì¼€ì´ìŠ¤ë“¤ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
        <ul>
          <li>[I love], [love you], [you forever]</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ìœ„ì™€ ê°™ì´ <code class="language-plaintext highlighter-rouge">n-grams</code>ëŠ”  text ë³¸ë˜ì˜ ì‹œí€€ìŠ¤ êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ë‹¤ ë³´ë‹ˆ <code class="language-plaintext highlighter-rouge">BoW</code>ë³´ë‹¤ ë” ìœ ìš©í•œ ì •ë³´ë¥¼ ì¤„ ìˆ˜ ìˆì§€ë§Œ, <u>ì²˜ë¦¬ ë¹„ìš©ì´ ì¦ê°€</u>ëœë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">n-grams</code>ëŠ” ì´ë¡ ìƒ textì— $k$ê°œì˜ ê³ ìœ í•œ ë‹¨ì–´ê°€ ìˆì„ ë•Œ $k^2$ê°œì˜ bigramsê°€ ìˆì„ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ëª¨ë“  ë‹¨ì–´ê°€ ë‹¤ë¥¸ ëª¨ë“  ë‹¨ì–´ë¥¼ ë’¤ë”°ë¥´ì§€ ì•Šê¸°ì— $k^2$ê³¼ ê°™ì€ ê²½ìš°ëŠ” ê±°ì˜ ì—†ë‹¤. í•˜ì§€ë§Œ, ì¼ë°˜ì ì¸ ë¬¸ì¥ ë‚´ì˜ <code class="language-plaintext highlighter-rouge">n-grams</code>ëŠ” ê³ ìœ  ë‹¨ì–´ ê°¯ìˆ˜ë³´ë‹¤ ë§ë‹¤.
    <ul>
      <li>í•˜ì§€ë§Œ $n$ì´ <strong>ì»¤ì§ˆìˆ˜ë¡</strong> corpusì—ì„œ íŠ¹ì • ë‹¨ì–´ë“¤ì˜ ì—°ì† ë‚˜ì—´ ë¬¶ìŒì´ í¬í•¨ëœ n-gramì„ ì¹´ìš´íŠ¸í•  ìˆ˜ ìˆëŠ” í™•ë¥ ì´ ì ì–´ì§€ê¸°ì— <strong>í¬ì†Œ ë¬¸ì œ</strong><u>ëŠ” ì‹¬ê°</u>í•´ì§€ë©°, ëª¨ë“  ê²½ìš°ì˜ n-gramì„ ì¹´ìš´íŒ…í•˜ê¸° ë•Œë¬¸ì— ëª¨ë¸ì˜ ì‚¬ì´ì¦ˆê°€ ë„ˆë¬´ ì»¤ì§„ë‹¤ëŠ” ë¬¸ì œì ë„ ìˆë‹¤.</li>
      <li>$n$ì„ <strong>ë„ˆë¬´ ì‘ê²Œ</strong> ì„¤ì •í•  ê²½ìš° corpusì—ì„œ ë‹¨ì–´ì˜ ì¹´ìš´íŠ¸ëŠ” ì˜ë˜ê² ì§€ë§Œ, <u>ë‹¨ì–´ ì˜ˆì¸¡ì˜ ì •í™•ë„ê°€ ë–¨ì–´ì§„ë‹¤.</u></li>
      <li>ë”°ë¼ì„œ, <u>ì ì ˆí•œ $n$ì„ ì„ íƒí•˜ëŠ” ê²ƒë„ ì¤‘ìš”</u>í•˜ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì •í™•ë„ë¥¼ ë†’ì´ë ¤ë©´ $n&lt;5$ë¥¼ ê¶Œì¥í•˜ê³ ìˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<p>ë‹¤ìŒì€ $n$ì´ ì¦ê°€í•¨ì— ë”°ë¼ <code class="language-plaintext highlighter-rouge">n-grams</code>ì˜ ìˆ˜ê°€ ì–¼ë§ˆë‚˜ ì¦ê°€í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ì´ì „ì— ì‚¬ìš©í•œ Yelp ë¦¬ë·° ë°ì´í„°ì…‹ì˜ n-gramsë¥¼ ê³„ì‚°í•´ë³´ì.</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">pandas</code>ì™€ <code class="language-plaintext highlighter-rouge">scikit-learn</code>ì— ìˆëŠ” <code class="language-plaintext highlighter-rouge">CountVectorizer</code> ë³€í™˜ê¸°ë¥¼ ì‚¬ìš©í•œë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'./example_data/archive/yelp_academic_dataset_review.json'</span><span class="p">,</span>  <span class="n">encoding</span><span class="o">=</span><span class="s">'UTF8'</span><span class="p">)</span>
<span class="n">js</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
    <span class="n">js</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">readline</span><span class="p">()))</span>
<span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">review_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">js</span><span class="p">)</span>
<span class="n">review_df</span><span class="p">[</span><span class="s">'text'</span><span class="p">]</span> <span class="c1">#ë¦¬ë·°!
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0       As someone who has worked with many museums, I...
1       I am actually horrified this place is still in...
2       I love Deagan's. I do. I really do. The atmosp...
3       Dismal, lukewarm, defrosted-tasting "TexMex" g...
4       Oh happy day, finally have a Canes near my cas...
                              ...                        
9995    I came here to get a pedicure. Worst experienc...
9996    Excellent service and excellent food! We ate b...
9997    In line with and one of the best massages I ha...
9998    Virginia has been our vet for 6 years. She has...
9999    If the $5.99 lunch special proves to be as awe...
Name: text, Length: 10000, dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># unigram, bigrams, trigramsì— ëŒ€í•œ í”¼ì²˜ ë³€í™˜ê¸° ìƒì„±
# ê¸°ë³¸ ì˜µì…˜ìœ¼ë¡œ aì™€ bê°™ì€ í•˜ë‚˜ì˜ ë¬¸ìë¡œ ëœ ë‹¨ì–´ë¥¼ ë¬´ì‹œí•œë‹¤.
# ì´ëŠ” ì‹¤ì „ì—ì„œ ì˜ë¯¸ ì—†ëŠ” ë‹¨ì–´ë“¤ì„ ì œê±°í•˜ê¸° ë•Œë¬¸ì— ë§¤ìš° ìœ ìš©í•˜ì§€ë§Œ 
# í•˜ì§€ë§Œ ì—¬ê¸°ì„œëŠ” í•˜ë‚˜ì˜ ë¬¸ìë¡œ ëœ ë‹¨ì–´ë“¤ì„ ì„¤ëª…ì„ ìœ„í•´ token_pattern ë§¤ê°œë³€ìˆ˜ë¥¼ ì´ìš©í•´ 
# ëª…ì‹œì ìœ¼ë¡œ í¬í•¨ì‹œí‚¬ ê²ƒì´ë‹¤.
</span>
<span class="c1"># token_pattern : í† í° ì •ì˜ìš© ì •ê·œ í‘œí˜„ì‹
</span>
<span class="c1"># ngram_range ë§¤ê°œë³€ìˆ˜ì˜ ì¡°ì •ì— ë”°ë¼ ì›í•˜ëŠ” n-gramì„ ë„ì¶œí•  ìˆ˜ ìˆë‹¤.
# ngram_range = (1, 1) : unigrams
# ngram_range = (1, 2) : unigrams &amp; bigrams
# ngram_range = (2, 2) : bigrams
</span>
<span class="n">bow_converter</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">token_pattern</span> <span class="o">=</span> <span class="s">'</span><span class="se">\\</span><span class="s">b</span><span class="se">\\</span><span class="s">w+</span><span class="se">\\</span><span class="s">b'</span><span class="p">)</span>
<span class="n">bigram_converter</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">token_pattern</span> <span class="o">=</span> <span class="s">'</span><span class="se">\\</span><span class="s">b</span><span class="se">\\</span><span class="s">w+</span><span class="se">\\</span><span class="s">b'</span><span class="p">)</span>
<span class="n">trigram_converter</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">token_pattern</span> <span class="o">=</span> <span class="s">'</span><span class="se">\\</span><span class="s">b</span><span class="se">\\</span><span class="s">w+</span><span class="se">\\</span><span class="s">b'</span><span class="p">)</span>
<span class="n">quadgram_converter</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">token_pattern</span> <span class="o">=</span> <span class="s">'</span><span class="se">\\</span><span class="s">b</span><span class="se">\\</span><span class="s">w+</span><span class="se">\\</span><span class="s">b'</span><span class="p">)</span>
<span class="n">pentgram_converter</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">token_pattern</span> <span class="o">=</span> <span class="s">'</span><span class="se">\\</span><span class="s">b</span><span class="se">\\</span><span class="s">w+</span><span class="se">\\</span><span class="s">b'</span><span class="p">)</span>
<span class="n">hexgram_converter</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">ngram_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">token_pattern</span> <span class="o">=</span> <span class="s">'</span><span class="se">\\</span><span class="s">b</span><span class="se">\\</span><span class="s">w+</span><span class="se">\\</span><span class="s">b'</span><span class="p">)</span>

<span class="c1"># ë³€í™˜ì„ ìˆ˜í–‰í•œ í›„ ìš©ì–´ì§‘ í¬ê¸° í™•ì¸
</span><span class="n">bow_converter</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">review_df</span><span class="p">[</span><span class="s">'text'</span><span class="p">])</span>
<span class="n">bigram_converter</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">review_df</span><span class="p">[</span><span class="s">'text'</span><span class="p">])</span>
<span class="n">trigram_converter</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">review_df</span><span class="p">[</span><span class="s">'text'</span><span class="p">])</span>
<span class="n">quadgram_converter</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">review_df</span><span class="p">[</span><span class="s">'text'</span><span class="p">])</span>
<span class="n">pentgram_converter</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">review_df</span><span class="p">[</span><span class="s">'text'</span><span class="p">])</span>
<span class="n">hexgram_converter</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">review_df</span><span class="p">[</span><span class="s">'text'</span><span class="p">])</span>

<span class="n">words</span> <span class="o">=</span> <span class="n">bow_converter</span><span class="p">.</span><span class="n">get_feature_names</span><span class="p">()</span>
<span class="n">bigrams</span> <span class="o">=</span> <span class="n">bigram_converter</span><span class="p">.</span><span class="n">get_feature_names</span><span class="p">()</span>
<span class="n">trigrams</span> <span class="o">=</span> <span class="n">trigram_converter</span><span class="p">.</span><span class="n">get_feature_names</span><span class="p">()</span>
<span class="n">quadgrams</span> <span class="o">=</span> <span class="n">quadgram_converter</span><span class="p">.</span><span class="n">get_feature_names</span><span class="p">()</span>
<span class="n">pentgrams</span> <span class="o">=</span> <span class="n">pentgram_converter</span><span class="p">.</span><span class="n">get_feature_names</span><span class="p">()</span>
<span class="n">hexgrams</span> <span class="o">=</span> <span class="n">hexgram_converter</span><span class="p">.</span><span class="n">get_feature_names</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">x_ticks_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'unigram'</span><span class="p">,</span> <span class="s">'bigrams'</span><span class="p">,</span> <span class="s">'trigrams'</span><span class="p">,</span> <span class="s">'quadgrams'</span><span class="p">,</span> <span class="s">'pentgrams'</span><span class="p">,</span> <span class="s">'hexgrams'</span><span class="p">]</span>
<span class="n">length</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">bigrams</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">trigrams</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">quadgrams</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">pentgrams</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hexgrams</span><span class="p">)]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="s">'rs--'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">x_ticks_labels</span><span class="p">,</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'count for n-grams (0&lt;=n&lt;=6)'</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Yelp ë°ì´í„°ì…‹ì˜ ì²˜ìŒ 10,000ê°œ ë¦¬ë·°ì˜ n-grams ìˆ˜'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s">'plain'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s">'y'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">get_yaxis</span><span class="p">().</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">matplotlib</span><span class="p">.</span><span class="n">ticker</span><span class="p">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s">','</span><span class="p">)))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ngrams í™•ì¸
</span><span class="k">print</span><span class="p">(</span><span class="s">'words : '</span><span class="p">,</span> <span class="n">words</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'bigrams : '</span><span class="p">,</span> <span class="n">bigrams</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'trigrams : '</span><span class="p">,</span> <span class="n">trigrams</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'quadgrams : '</span><span class="p">,</span> <span class="n">quadgrams</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'pentgrams : '</span><span class="p">,</span> <span class="n">pentgrams</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'hexgrams : '</span><span class="p">,</span> <span class="n">hexgrams</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/53929665/108627158-87abd080-7497-11eb-8d9f-30986d778879.png" alt="FE_chapter3-1_17_0" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>words :  ['0', '00', '000', '00a', '00am', '00p', '00pm', '00service', '01', '0100pm'] 

bigrams :  ['0 00', '0 03', '0 3', '0 35', '0 5', '0 50', '0 75', '0 99', '0 and', '0 are'] 

trigrams :  ['0 00 balance', '0 03 i', '0 3 this', '0 35 ea', '0 5 for', '0 50 difference', '0 50 extra', '0 50 or', '0 75 but', '0 99 charge'] 

quadgrams :  ['0 00 balance and', '0 03 i know', '0 3 this place', '0 35 ea to', '0 5 for food', '0 50 difference that', '0 50 extra depending', '0 50 or 1', '0 75 but it', '0 99 charge for'] 

pentgrams :  ['0 00 balance and than', '0 03 i know it', '0 3 this place has', '0 35 ea to be', '0 5 for food on', '0 50 difference that fifty', '0 50 extra depending on', '0 50 or 1 00', '0 75 but it was', '0 99 charge for cheese'] 

hexgrams : ['0 00 balance and than got', '0 03 i know it s', '0 3 this place has been', '0 35 ea to be exact', '0 5 for food on the', '0 50 difference that fifty cent', '0 50 extra depending on which', '0 50 or 1 00 for', '0 75 but it was the', '0 99 charge for cheese and']
</code></pre></div></div>

<p>$n$ì´ ì ì  ì»¤ì§€ë©´ì„œ corpusì—ì„œ ì„œì¹˜í•˜ëŠ” n-gramì´ í¬ê´„ì ì´ê²Œ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” ì„œì¹˜í•˜ê¸¸ ì›í•˜ëŠ” n-gramì„ ì¹´ìš´íŠ¸ í•  ìˆ˜ ìˆëŠ” í™•ë¥ ì´ ì ì–´ì§€ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ë¯€ë¡œ ê¸ì •ì ì¸ ê²ƒì€ ì•„ë‹ˆë‹¤. ë˜í•œ,  ëª¨ë¸ ì‚¬ì´ì¦ˆê°€ ë§¤ìš° ì»¤ì§€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><br /></p>

<hr />

<h3 id="references">References</h3>

<ul>
  <li>Alice Zheng, Amanda Casari, ã€Feature Engineering for Machine Learning - PRRINCIPLES AND TECHNIQUES FOR DATA SCIENTISTSã€, Oâ€™Relly Media (2018)</li>
  <li>https://wikidocs.net/21692</li>
</ul>

:ET
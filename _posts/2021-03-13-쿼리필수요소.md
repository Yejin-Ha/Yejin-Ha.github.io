---
layout: post
title:  "[BigQuery] 쿼리필수요소 SELECT & WHERE"
subtitle: "[BigQuery] 쿼리필수요소 SELECT & WHERE"
categories: gcp
tags: bigquery
comments: true
---

- SELECT로 행 탐색하기
	- BigQuery 테이블 구조
	- SELECT EXCEPT
	- SELECT REPLACE
	- SELECT DISTINCT
- WHERE절로 필터링하기

본 포스팅의 자료는  『구글 빅쿼리 완벽 가이드』의 내용을 참고하였습니다.

<br>

- - -

### 1)  SELECT로 행 탐색하기
- BigQuery의 테이블 구조 : [프로젝트ID].[데이터셋].[테이블]
	- `프로젝트ID` : 데이터셋 및 해당 테이블과 관련된 영구 저장소의 소유권
	- 그러므로, `데이터셋`과 관련된 스토리지 비용은 `프로젝트ID`의 소유자가 비용을 부담한다.
	- 테이블을 FROM으로 부를 때, `하이픈(-)`을 사용하는 프로젝트ID 및 데이터셋의 경우 뺄셈으로 해석될 수 있기 때문에 `백틱`으로 묶어 사용해줘야한다.
		- 하지만, 이렇게하면 테이블 이름을 별칭으로 사용할 수 없다.
		- 따라서, 프로젝트 이름만 `백틱`으로 둘러싸고 데이터셋과 테이블의 이름에는 하이픈을 사용하지 않는 습관을 기르는 것이 좋다.<br>ex) `bigquery-public-data`.new_york_citibike.citibike_trips

- `SELECT EXCEPT` : 일부 컬럼을 제외한 나머지 컬럼을 모두 선택할 때 사용한다.
	- ex) ```SELECT * EXCEPT(col1, col2)```<br>col1과 col2 컬럼을 제외한 모든 열을 출력한다.

- `SELECT REPLACE` : 모든 컬럼을 선택하면서 그 중 <b>한 컬럼</b>의 값을 변환할 때 사용한다.
	- ex) ```SELECT * REPLACE(col1+5 AS col1)```<br>모든 열을 출력하면서 col1컬럼만 5를 더해서 col2라는 이름으로 지칭한다.

- `SELECT DISTINCT` : SELECT절에서 지정한 컬럼 전체에 적용된다! 따라서, 이를 이용하면 데이터셋에서 선별한 컬럼의  모든 조합에 해당하는 결과를 얻을 수 있다.

<br>

- - - 

### 2)  WHERE절로 필터링하기
- `WHERE`절은 `FROM` 절에서 지정한 테이블의 컬럼을 참조하기에 `SELECT`절에서 지정한 별칭을 참조할 수 없다.
-  하지만, `GROUP BY`, `ORDER BY`절에는 사용할 수 있다. 왜냐하면 이것들은 `SELECT`절이 실행된 이후 실행되기 때문이다. 


<br>

- - -

### References
- 『구글 빅쿼리 완벽 가이드』, 발리아파 락쉬마난, 조던 티가니 지음, 변성윤, 장현희 옮김, 책만, 9791189909239



